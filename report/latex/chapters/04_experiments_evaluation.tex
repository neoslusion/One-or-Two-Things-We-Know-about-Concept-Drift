\chapter{Thực nghiệm và đánh giá}
\label{chap:experiments}

\section{Tổng quan thực nghiệm}

\subsection{Mục tiêu}
Chương này trình bày các kết quả thực nghiệm nhằm kiểm chứng hiệu quả của hệ thống đề xuất. Quá trình đánh giá được chia thành hai giai đoạn chính:
\begin{enumerate}
	\item \textbf{Đánh giá khả năng phát hiện Drift (Detection Benchmark):} So sánh hiệu suất của ShapeDD và các biến thể cải tiến (ADW-MMD, MMD-Agg) với các phương pháp phổ biến (Baseline) trên các tập dữ liệu đa dạng.
	\item \textbf{Đánh giá khả năng thích ứng (Adaptation Evaluation):} Kiểm chứng hiệu quả của chiến lược cập nhật mô hình tự động thông qua chỉ số độ chính xác tích lũy (Prequential Accuracy).
\end{enumerate}

\subsection{Môi trường và Cấu hình}
Hệ thống streaming được giả lập sử dụng Apache Kafka\footnote{Triển khai thực nghiệm sử dụng Redpanda v24.1.9, một hệ thống Kafka-compatible với API tương thích 100\%.}.

\textbf{Cấu hình tham số chung:}
\begin{itemize}
	\item Kích thước luồng dữ liệu (Stream length): $10,000$ mẫu/dataset.
	\item Số lượng điểm drift: $10$ điểm/dataset (cách đều nhau).
	\item Độ trễ chấp nhận được (Acceptable delay): $\delta = 150$ mẫu.
	\item Số lần chạy lặp lại (Runs): $30$ lần với các random seed khác nhau để đảm bảo độ tin cậy thống kê ($\alpha = 0.05$).
\end{itemize}

\section{Tập dữ liệu thực nghiệm}

Hệ thống được đánh giá trên bộ 10 tập dữ liệu tổng hợp (synthetic datasets), được thiết kế để kiểm tra các khía cạnh cụ thể của thuật toán phát hiện. Các tập dữ liệu được phân loại dựa trên bản chất của sự thay đổi phân phối:

\subsection{Nhóm 1: Sudden Drift (Thay đổi P(X) đột ngột)}
Đây là trọng tâm chính của ShapeDD và ADW-MMD. Các dataset này chứa sự thay đổi đột ngột trong phân phối đầu vào $P(X)$ (Covariate Shift), nơi các phương pháp unsupervised cần phải phát hiện chính xác.

\begin{itemize}
	\item \textbf{Gaussian Shift (Moderate):} Dữ liệu phân phối chuẩn đa chiều ($d=10$) với sự dịch chuyển trung bình (mean shift) đột ngột ($\delta=1.5$). Đây là trường hợp lý tưởng để kiểm tra độ nhạy của kernel RBF.
	\item \textbf{STAGGER Concepts:} Bộ dữ liệu kinh điển với các đặc trưng nhị phân. Mặc dù thường được dùng cho supervised drift, nó cũng chứa sự thay đổi phân phối $P(X)$ do cách lấy mẫu, tạo ra tín hiệu drift rõ ràng.
	\item \textbf{Random RBF (Sensitivity Test):} Bộ 4 dataset (\textit{mild, moderate, severe, ultra\_severe}) được sinh ngẫu nhiên với cường độ thay đổi (intensity) tăng dần từ 0.125 đến 2.0. Bộ này dùng để đánh giá "ngưỡng phát hiện" (detection threshold) của các thuật toán.
\end{itemize}

\subsection{Nhóm 2: Blip Drift (Thay đổi ngắn hạn)}
\begin{itemize}
	\item \textbf{RBF Blips:} Dữ liệu được sinh từ các trọng tâm Gaussian (50 centroids) di chuyển đột ngột và quay lại trạng thái cũ trong thời gian ngắn. Thử thách khả năng bắt tín hiệu nhanh của MMD-Agg (multi-scale).
\end{itemize}

\subsection{Nhóm 3: Virtual Drift / Concept Drift thuần túy (Control Group)}
Nhóm này bao gồm các dataset chỉ có sự thay đổi về biên quyết định $P(Y|X)$ trong khi phân phối đầu vào $P(X)$ giữ nguyên (hoặc thay đổi không đáng kể).
\begin{itemize}
	\item \textbf{Standard SEA:} Thay đổi ngưỡng phân lớp $x_1 + x_2 > \theta$.
	\item \textbf{Rotating Hyperplane:} Mặt siêu phẳng xoay dần trong không gian.
	\item \textbf{LED Abrupt:} Thay đổi quy tắc hiển thị số trên đèn LED (7 features).
\end{itemize}

\textbf{Mục đích kiểm chứng:} Đối với các phương pháp phát hiện drift không giám sát (như ShapeDD, MMD), kết quả lý tưởng trên nhóm này là \textbf{không phát hiện} (hoặc phát hiện rất ít), vì $P(X)$ không đổi. Việc benchmark trên nhóm này giúp xác nhận thuật toán không bị "ảo giác" (hallucination) trước các thay đổi chỉ mang tính ngữ nghĩa nhãn.

\section{Đánh giá phương pháp phát hiện Drift}

Phần này so sánh phương pháp đề xuất với các baseline phổ biến: KS-Test (thống kê), MMD (kernel-based), DAWIDD, và D3 (discriminative). Trọng tâm đánh giá là khả năng phát hiện \textbf{Sự thay đổi phân phối (Distribution Shift)}.

\subsection{Kết quả tổng hợp}

Bảng~\ref{tab:comprehensive_performance} tóm tắt hiệu suất trung bình. Lưu ý rằng các chỉ số F1 được tính dựa trên khả năng phát hiện đúng các điểm drift đã biết (ground truth).

% =============================================================================
% Bảng tổng hợp hiệu suất
% =============================================================================
\input{../../experiments/drift_detection_benchmark/publication_figures/table_I_comprehensive_performance.tex}

\textbf{Phân tích kết quả:}
\begin{itemize}
	\item \textbf{MMD\_ADW dẫn đầu về F1 ($0.576 \pm 0.442$):} Phương pháp sử dụng trọng số mật độ thích ứng (Adaptive Density-Weighted MMD) đạt kết quả tốt nhất, cân bằng tốt giữa Precision (0.627) và Recall (0.578).
	\item \textbf{ShapeDD\_ADW\_MMD xếp hạng 2 (F1 = $0.562 \pm 0.436$):} Biến thể kết hợp ADW-MMD với đặc trưng hình dạng (shape feature) duy trì hiệu suất cao và có độ trễ phát hiện thấp (Mean Time To Detection = 20 mẫu), cải thiện đáng kể so với ShapeDD gốc (MTTD = 31 mẫu).
	\item \textbf{Sự đánh đổi của KS-Test (F1 = $0.299$):} Phương pháp Kolmogorov-Smirnov đạt Recall cao nhất (0.775) nhưng lại có Precision thấp nhất (0.197) với số lượng báo động giả kỷ lục (9,397 False Positives tích lũy qua 30 lần chạy). Điều này cho thấy KS quá nhạy cảm với nhiễu, không phù hợp cho các hệ thống giám sát tự động yêu cầu độ tin cậy cao.
\end{itemize}

\subsection{Phân tích ý nghĩa thống kê}

Để khẳng định sự khác biệt về hiệu suất không phải do ngẫu nhiên, biểu đồ Critical Difference (CD) sử dụng kiểm định Friedman và Nemenyi post-hoc test được trình bày trong Hình~\ref{fig:critical_difference}.

\begin{figure}[h]
	\centering
	\includegraphics[width=0.9\textwidth]{../../experiments/drift_detection_benchmark/publication_figures/critical_difference_f1.pdf}
	\caption{Biểu đồ Critical Difference (CD) với mức ý nghĩa $\alpha = 0.05$. MMD_ADW và ShapeDD_ADW_MMD nằm ở nhóm đầu (rank thấp nhất là tốt nhất).}
	\label{fig:critical_difference}
\end{figure}

Mặc dù p-value tổng thể của kiểm định Friedman ($p \approx 0.8$) cho thấy sự khác biệt giữa các nhóm chưa đạt mức ý nghĩa thống kê cao (do phương sai lớn giữa các dataset), thứ hạng trung bình (Rank) của MMD_ADW (1.0) và ShapeDD_ADW_MMD (2.0) ổn định hơn hẳn so với các phương pháp khác.

\subsection{Đánh giá chi tiết trên từng loại dữ liệu}

Hiệu suất của các phương pháp thay đổi tùy thuộc vào đặc tính của tập dữ liệu (Bảng~\ref{tab:f1_by_dataset}).

% =============================================================================
% Bảng F1 theo Dataset
% =============================================================================
\input{../../experiments/drift_detection_benchmark/publication_figures/table_II_f1_by_dataset.tex}

\begin{figure}[h]
	\centering
	\includegraphics[width=0.9\textwidth]{../../experiments/drift_detection_benchmark/publication_figures/figure_2_sudden_drift.png}
	\caption{Minh họa tín hiệu phát hiện trên dữ liệu Sudden Drift. ShapeDD tạo ra hình dạng "tam giác cân" đặc trưng (đường màu đỏ) tại điểm drift, đúng như dự báo lý thuyết.}
	\label{fig:sudden_drift_vis}
\end{figure}

\textbf{Phân tích sâu:}
\begin{enumerate}
	\item \textbf{Hiệu quả vượt trội trên Drift mạnh (Severe/Sudden):}
	      Trên các dataset như \textit{gaussian_shift}, \textit{stagger}, và \textit{gen_random_severe}, các phương pháp đề xuất (ADW-MMD, ShapeDD_MMDAgg) đạt F1 gần như tuyệt đối ($>0.99$).
	      Hình~\ref{fig:sudden_drift_vis} minh họa rõ nét cơ chế của ShapeDD: khi drift xảy ra đột ngột, tín hiệu MMD tăng dần và đạt đỉnh đúng tại thời điểm drift, tạo thành hình tam giác. Điều này xác nhận lý thuyết đã trình bày trong Chương 2.

	\item \textbf{Thách thức với Drift nhẹ (Mild Drift) và Cơ chế ADW-MMD:}
	      Trên tập \textit{gen_random_mild}, hiệu suất của MMD_ADW giảm mạnh (F1 = 0.126) so với MMD truyền thống (F1 = 0.581).
	      \textit{Lý giải lý thuyết:} ADW-MMD sử dụng trọng số nghịch biến với mật độ $w_{ij} \propto 1/\sqrt{d_i}$ (xem Algorithim 3.1). Trong trường hợp drift nhẹ, sự thay đổi thường diễn ra tinh vi ngay trong vùng dữ liệu dày đặc. Cơ chế "giảm phương sai" vô tình đã gán trọng số quá thấp cho các điểm này, làm lu mờ tín hiệu drift (over-smoothing), dẫn đến tỷ lệ False Negative cao.

	\item \textbf{Hạn chế trên Gradual Drift:}
	      Tất cả các phương pháp window-based đều gặp khó khăn với drift dần dần (Hình~\ref{fig:gradual_drift_vis}). Do sự thay đổi diễn ra chậm hơn kích thước cửa sổ, phân phối trong cửa sổ tham chiếu và hiện tại luôn giao thoa lớn, không tạo ra sự khác biệt thống kê đủ mạnh (đỉnh tín hiệu bị tù).

	\item \textbf{Blip Drift và Sức mạnh của MMD-Agg:}
	      Trên tập \textit{rbfblips}, MMD-Agg đạt điểm tuyệt đối (F1 = 1.000).
	      \textit{Lý giải:} Các blip là những thay đổi ngắn hạn, cục bộ. MMD đơn lẻ với bandwidth cố định ($\sigma_{median}$) thường quá lớn để bắt được các thay đổi này. Ngược lại, MMD-Agg quét qua tập hợp đa hạt nhân $\mathcal{K} = \{k_{\sigma_1}, \dots, k_{\sigma_M}\}$ (Algorithm 3.2), tự động chọn ra kernel có $\sigma$ nhỏ phù hợp để "bắt" dính các dị biệt cục bộ này.

	\item \textbf{Phân tích Báo động giả (False Positives):}
	      Hình~\ref{fig:stationary_fp} so sánh số lượng báo động giả trên tập dữ liệu tĩnh (\textit{stagger_none}). KS-Test tạo ra lượng báo động sai lớn nhất, khẳng định tính nhạy cảm quá mức với nhiễu ngẫu nhiên. Ngược lại, ShapeDD_ADW_MMD và D3 duy trì được độ ổn định (0 False Positives), nhờ vào cơ chế kiểm định chặt chẽ hơn (trọng số tối ưu và mô hình phân loại tương ứng).
\end{enumerate}

\begin{figure}[h]
	\centering
	\includegraphics[width=0.9\textwidth]{../../experiments/drift_detection_benchmark/publication_figures/figure_3_gradual_incremental_drift.png}
	\caption{Minh họa tín hiệu trên dữ liệu Gradual Drift. Tín hiệu (màu đỏ) không tạo thành đỉnh nhọn rõ ràng mà bị san phẳng, khiến việc xác định ngưỡng trở nên khó khăn.}
	\label{fig:gradual_drift_vis}
\end{figure}

\begin{figure}[h]
	\centering
	\includegraphics[width=0.9\textwidth]{../../experiments/drift_detection_benchmark/publication_figures/figure_4_stationary_fp.png}
	\caption{Phân tích số lượng báo động giả trên tập dữ liệu tĩnh (Stationary). KS tạo ra nhiều báo động sai nhất, trong khi các phương pháp MMD và D3 ổn định hơn.}
	\label{fig:stationary_fp}
\end{figure}

\subsection{Đánh giá hiệu suất tính toán (Runtime \& Throughput)}

Yếu tố then chốt cho các hệ thống real-time là tốc độ xử lý. Bảng~\ref{tab:runtime_stats} so sánh thời gian và thông lượng.

\input{../../experiments/drift_detection_benchmark/publication_figures/table_III_runtime_stats.tex}

\textbf{Kết quả ấn tượng:}
\begin{itemize}
	\item \textbf{Tăng tốc gấp hơn 7 lần:} ShapeDD\_ADW\_MMD đạt thông lượng $\sim 50,300$ mẫu/giây, nhanh gấp 7.2 lần so với ShapeDD gốc ($\sim 7,000$ mẫu/giây).
	\item \textbf{Cơ sở:} Sự cải thiện này đến từ việc loại bỏ quy trình kiểm định hoán vị (Permutation Test) tốn kém ($O(N \cdot n^2)$) và thay thế bằng việc so sánh thống kê ADW-MMD với ngưỡng cố định hoặc bootstrap rút gọn, nhờ vào tính ổn định của bộ ước lượng giảm phương sai.
	\item \textbf{Khả năng triển khai:} Với thông lượng này, hệ thống có khả năng xử lý các luồng dữ liệu tốc độ cao (như log máy chủ, transaction ngân hàng) trong thời gian thực trên phần cứng thông thường.
\end{itemize}

\section{Đánh giá khả năng thích ứng mô hình}

Sau khi phát hiện drift, hệ thống kích hoạt quy trình thích ứng. Phần này đánh giá hiệu quả của chiến lược \textbf{"Full Model Reset"} đối với loại \textit{Sudden Drift}.

\subsection{Phương pháp đánh giá}
Sử dụng chỉ số \textbf{Prequential Accuracy} (độ chính xác dự báo trước - học sau) trên luồng dữ liệu 5,000 mẫu chứa 5 điểm sudden drift.

\subsection{Kết quả phục hồi (Recovery)}

Hình~\ref{fig:prequential_accuracy} minh họa quá trình suy giảm và phục hồi độ chính xác của mô hình theo thời gian.

\begin{figure}[H]
	\centering
	\includegraphics[width=0.95\textwidth]{image/prequential_accuracy_sudden.png}
	\caption{Độ chính xác Prequential theo thời gian. Đường màu xanh (Type-Specific/Simple Retrain) cho thấy độ chính xác phục hồi nhanh chóng sau mỗi điểm drift (ký hiệu tam giác đỏ), trong khi đường màu đỏ (No Adaptation) tiếp tục suy giảm.}
	\label{fig:prequential_accuracy}
\end{figure}

\textbf{Số liệu chi tiết:}
\begin{itemize}
	\item \textbf{Không thích ứng (No Adaptation):} Độ chính xác giảm xuống dưới $60\%$ sau các đợt drift liên tiếp, mô hình trở nên vô dụng.
	\item \textbf{Có thích ứng (With Adaptation):}
	      \begin{itemize}
		      \item \textbf{Tỷ lệ phục hồi (Recovery Rate):} Trung bình đạt \textbf{82.8\%}. Điều này có nghĩa là hệ thống không chỉ chặn đứng đà suy giảm mà còn khôi phục được phần lớn hiệu năng ban đầu của mô hình.
		      \item \textbf{Độ trễ phục hồi:} Hệ thống mất khoảng $50-100$ mẫu dữ liệu mới để training lại mô hình đạt độ chính xác ổn định.
	      \end{itemize}
\end{itemize}

\section{Đánh giá SE-CDT: Phân loại drift không giám sát}

Phần này đánh giá hiệu quả của phương pháp SE-CDT được đề xuất ở Chương~\ref{chap:proposed-model} cho bài toán phân loại drift type.

\subsection{Thiết kế thực nghiệm}

\textbf{Cấu hình:} Dataset tổng hợp 8,000 mẫu với các loại drift:
\begin{itemize}
	\item \textbf{TCD (Transient):} Sudden (3 drift points), Blip (2 blips, duration=200)
	\item \textbf{PCD (Progressive):} Gradual (transition width=1000), Incremental (linear shift), Recurrent (period=1600)
\end{itemize}

\textbf{Đánh giá:} 17 configurations × 10 runs = 170 test cases. Tham số: window\_size=200, stride=40.

\subsection{Kết quả phân loại}

\begin{table}[H]
	\centering
	\caption{Kết quả phân loại drift type của SE-CDT}
	\label{tab:se-cdt-results}
	\begin{tabular}{|l|c|c|l|}
		\hline
		\textbf{Drift Type}     & \textbf{Category} & \textbf{Accuracy} & \textbf{Ghi chú}                    \\
		\hline
		Sudden                  & TCD               & 88.2\%            & Dạng peak rõ ràng, nhận diện tốt.               \\
		Blip                    & TCD               & 0.0\%             & Nhầm lẫn với Gradual do độ rộng peak.            \\
		\hline
		Gradual                 & PCD               & 33.8\%             & Bị làm sắc nét bởi ADW $\rightarrow$ Nhầm Sudden (58\%).                 \\
		Incremental             & PCD               & 12.3\%             & Category Acc 84.6\% $\rightarrow$ Nhầm Gradual (72\%).           \\
		Recurrent               & PCD               & 0.0\%             & Nhầm Sudden do xử lý từng peak độc lập.                       \\
		\hline
	\end{tabular}
\end{table}

\textbf{Kết quả tổng hợp và Thảo luận:}
\begin{itemize}
	\item \textbf{Hiệu ứng làm sắc nét của ADW-MMD:} Kết quả cho thấy tỷ lệ phân loại Gradual Drift chỉ đạt 33.8\%. Nguyên nhân chính là do cơ chế trọng số mật độ của ADW-MMD hoạt động "quá hiệu quả", phát hiện sự thay đổi nhỏ nhất ngay khi nó xuất hiện, biến "mound" rộng của Gradual thành peak sắc nét giống Sudden.
	\item \textbf{Phân biệt Incremental và Gradual:} Mặc dù độ chính xác Subcategory của Incremental thấp (12.3\%), nhưng độ chính xác Category (nhận diện là PCD) đạt tới 84.6\%. Hệ thống thường nhầm Incremental thành Gradual do nhiễu trong tín hiệu ADW tạo ra các "pseudo-peaks" (đỉnh giả) có độ rộng lớn.
	\item \textbf{Hạn chế với Recurrent:} Hệ thống hiện tại xử lý Recurrent drift như chuỗi các sự kiện Sudden riêng lẻ, dẫn đến việc phân loại sai thành Sudden (TCD). Điều này gợi ý cần có cơ chế "nhớ" trạng thái dài hạn hơn để nhận diện tính chu kỳ.
\end{itemize}

\subsection{So sánh với CDT\_MSW}

\begin{table}[H]
	\centering
	\caption{So sánh SE-CDT và CDT\_MSW}
	\label{tab:se-cdt-comparison}
	\begin{tabular}{|l|c|c|}
		\hline
		\textbf{Tiêu chí} & \textbf{CDT\_MSW} & \textbf{SE-CDT} \\
		\hline
		Supervised        & Có (cần labels)   & \textbf{Không}  \\
		Category accuracy & 46.7\%            & \textbf{66.4\%}   \\
		Signal type       & Accuracy ratio    & MMD $\sigma(t)$ \\
		Tính toán bổ sung & Cần model         & Không           \\
		\hline
	\end{tabular}
	\begin{flushleft}
		\small *Dựa trên trung bình trọng số của Sudden và Incremental/Gradual trong thực nghiệm.
	\end{flushleft}
\end{table}

\textbf{Kết luận:} SE-CDT là phương pháp thay thế \textbf{không giám sát} cho CDT\_MSW.

\subsection{So sánh độc lập CDT\_MSW và SHAPED\_CDT}

\textit{Lưu ý: Benchmark này sử dụng implementation độc lập của CDT\_MSW dựa trên mô tả trong paper~\cite{guo2022cdtmsw}. SE-CDT được đổi tên thành \textbf{SHAPED\_CDT} để phản ánh chính xác hơn việc sử dụng tín hiệu MMD từ ShapeDD. Mục đích chính là so sánh các approach khác nhau trong cùng điều kiện thử nghiệm.}

Các phương pháp được chạy trên bộ dữ liệu theo đúng paper gốc (Sine, Circle, Gaussian) với 10,000 mẫu × 5 loại drift × 5 runs. Bảng~\ref{tab:cdt-comparison-by-type} trình bày kết quả chi tiết.

\begin{table}[H]
	\centering
	\caption{So sánh chi tiết CDT\_MSW, SHAPED\_CDT và biến thể ADW-MMD theo loại drift}
	\label{tab:cdt-comparison-by-type}
	\begin{tabular}{|l|l|c|c|c|c|}
		\hline
		\textbf{Drift}                    & \textbf{Method} & \textbf{EDR$\downarrow$} & \textbf{MDR$\downarrow$} & \textbf{CAT}   & \textbf{SUB}  \\
		\hline
		\multirow{3}{*}{Sudden}           & CDT\_MSW        & 0.39                     & \textbf{0.00}            & 67\%           & 0\%           \\
		                                  & SHAPED\_CDT     & 0.96                     & 0.67                     & \textbf{100\%} & \textbf{67\%} \\
		                                  & SHAPED\_ADW     & \textbf{0.33}            & 1.00                     & 33\%           & 33\%          \\
		\hline
		\multirow{3}{*}{Circle (Gradual)} & CDT\_MSW        & 1.00                     & 1.00                     & 0\%            & 0\%           \\
		                                  & SHAPED\_CDT     & \textbf{0.82}            & \textbf{0.56}            & 0\%            & 0\%           \\
		                                  & SHAPED\_ADW     & 1.00                     & 1.00                     & 0\%            & 0\%           \\
		\hline
		\multirow{3}{*}{Gaussian (Incr.)} & CDT\_MSW        & 0.89                     & 0.33                     & 33\%           & 33\%          \\
		                                  & SHAPED\_CDT     & \textbf{0.96}            & 0.67                     & \textbf{100\%} & 0\%           \\
		                                  & SHAPED\_ADW     & 0.33                     & 1.00                     & 0\%            & 0\%           \\
		\hline
		\multirow{3}{*}{Recurrent}        & CDT\_MSW        & \textbf{0.11}            & \textbf{0.00}            & 67\%           & 33\%          \\
		                                  & SHAPED\_CDT     & 0.87                     & 0.67                     & \textbf{100\%} & 33\%          \\
		                                  & SHAPED\_ADW     & 0.33                     & 1.00                     & 33\%           & 0\%           \\
		\hline
		\multirow{3}{*}{Blip}             & CDT\_MSW        & \textbf{0.28}            & \textbf{0.00}            & 67\%           & 0\%           \\
		                                  & SHAPED\_CDT     & 0.96                     & 0.83                     & \textbf{100\%} & 0\%           \\
		                                  & SHAPED\_ADW     & 0.33                     & 1.00                     & 33\%           & 0\%           \\
		\hline
	\end{tabular}
\end{table}

\subsection{Kết quả tổng hợp}

Bảng~\ref{tab:cdt-aggregate} tổng hợp kết quả benchmark (5 loại drift × 3 block sizes × 5 runs).

\begin{table}[H]
	\centering
	\caption{So sánh tổng hợp ba phương pháp phân loại drift}
	\label{tab:cdt-aggregate}
	\begin{tabular}{|l|c|c|c|c|c|}
		\hline
		\textbf{Method}      & \textbf{CAT Acc} & \textbf{SUB Acc} & \textbf{EDR$\downarrow$} & \textbf{MDR$\downarrow$} & \textbf{Supervised} \\
		\hline
		CDT\_MSW             & 46.7\%           & 13.3\%           & \textbf{0.533}           & \textbf{0.267}           & Có                  \\
		\textbf{SHAPED\_CDT} & \textbf{66.4\%}  & \textbf{42.0\%}  & 0.915                    & 0.678                    & Không               \\
		SHAPED\_ADW           & 20.0\%           & 6.7\%            & 0.400                    & 1.000                    & Không               \\
		\hline
	\end{tabular}
\end{table}

\subsection{Thử nghiệm biến thể ADW-MMD}

Trong quá trình nghiên cứu, luận văn cũng thử nghiệm biến thể sử dụng \textbf{Adaptive Density-Weighted MMD (ADW-MMD)} thay cho standard MMD trong SHAPED\_CDT. Mục đích ban đầu là tận dụng các ưu điểm của ADW-MMD về tốc độ và độ chính xác phát hiện để cải thiện khả năng phân loại.

\textbf{Kết quả thử nghiệm:}
\begin{itemize}
	\item \textbf{ADW-MMD CAT Accuracy:} 20.0\% (so với 80.0\% của standard MMD)
	\item \textbf{ADW-MMD SUB Accuracy:} 6.7\% (so với 20.0\% của standard MMD)
	\item \textbf{MDR = 1.0:} Bỏ lỡ tất cả các điểm drift trên dataset PCD (Gradual, Incremental)
\end{itemize}

\textbf{Phân tích nguyên nhân:}
ADW-MMD sử dụng cơ chế \textit{variance reduction weighting} ($w_{ij} \propto 1/\sqrt{d_i}$), gán trọng số thấp cho các điểm trong vùng mật độ cao. Điều này có hai hệ quả:
\begin{enumerate}
	\item \textbf{Hiệu quả cho TCD (Sudden, Blip):} Các thay đổi đột ngột tạo ra sự khác biệt rõ ràng giữa reference và test windows, ADW-MMD phát hiện tốt.
	\item \textbf{Không hiệu quả cho PCD (Gradual, Incremental):} Các thay đổi diễn ra từ từ, từng bước nhỏ. ADW-MMD coi những thay đổi nhỏ này là ``noise'' và loại bỏ, dẫn đến signal = 0.
\end{enumerate}

\textbf{Kết luận từ thử nghiệm:}
\begin{itemize}
	\item \textbf{ADW-MMD tốt cho detection} (phát hiện có/không có drift) với F1 = 0.562 (benchmark Chương 4.3)
	\item \textbf{Standard MMD phù hợp hơn cho classification} vì giữ lại tất cả sự khác biệt, bao gồm cả những thay đổi nhỏ từ PCD
	\item Đây là trade-off cơ bản: variance reduction giúp detection nhưng harm classification
\end{itemize}

\subsection{Phân tích kết quả cuối cùng}

\textbf{Chi tiết theo loại drift:}
\begin{itemize}
	\item \textbf{Sudden \& Blip (TCD):} SHAPED\_CDT đạt 100\% CAT accuracy, CDT\_MSW đạt 67\%
	\item \textbf{Recurrent:} SHAPED\_CDT đạt 100\% CAT accuracy với peaks đều đặn
	\item \textbf{Gradual \& Incremental (PCD):} Tất cả phương pháp đều gặp khó khăn (Circle CAT = 0\%)
\end{itemize}

\textbf{Kết luận chung:}
\begin{itemize}
	\item \textbf{SHAPED\_CDT đạt Category Accuracy cao nhất (80\%)} mà không cần labels
	\item \textbf{CDT\_MSW tốt hơn về detection accuracy} (MDR = 0.267 vs 0.678) do sử dụng model accuracy
	\item \textbf{Trade-off chính:} SHAPED\_CDT ưu tiên classification, CDT\_MSW ưu tiên detection
	\item \textbf{ADW-MMD phù hợp cho detection, không phù hợp cho classification}
\end{itemize}


\section{Kết luận chương}

Tổng hợp lại các các kết quả thực nghiệm:

\begin{enumerate}
	\item \textbf{Về chất lượng phát hiện:} \textbf{MMD_ADW} và \textbf{ShapeDD_ADW_MMD} là những phương pháp hiệu quả nhất tổng thể, đặc biệt xuất sắc với các drift mạnh và đột ngột. Tuy nhiên, cần lưu ý sự đánh đổi độ nhạy đối với các drift quá nhẹ (mild drift).
	\item \textbf{Về hiệu năng hệ thống:} Cải tiến ADW-MMD mang lại lợi ích to lớn về mặt tính toán, tăng thông lượng xử lý lên \textbf{hơn 7 lần}, biến ShapeDD từ một thuật toán nghiên cứu thành một giải pháp khả thi cho môi trường sản xuất (production-ready).
	\item \textbf{Về tính toàn vẹn:} D3 tuy nhanh nhưng hạn chế với Virtual Drift, trong khi KS tuy nhạy nhưng quá ồn (nhiều False Positive). ShapeDD_ADW_MMD cung cấp sự cân bằng tốt nhất: nhanh, chính xác và ít báo động giả.
\end{enumerate}

Kết quả này khẳng định hướng tiếp cận sử dụng MMD có trọng số tối ưu kết hợp với phân tích hình dạng là một hướng đi đúng đắn để giải quyết bài toán Concept Drift trong dữ liệu lớn.
