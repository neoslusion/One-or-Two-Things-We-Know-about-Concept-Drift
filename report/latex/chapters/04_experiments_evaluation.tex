\chapter{Thực nghiệm và đánh giá}
\label{chap:experiments}

\section{Tổng quan thực nghiệm}
\label{sec:overview}

\subsection{Mục tiêu và Cấu trúc chương}
Chương này trình bày các kết quả thực nghiệm nhằm kiểm chứng hiệu quả của hệ thống đề xuất. Quá trình đánh giá được chia thành hai giai đoạn chính:
\begin{enumerate}
	\item \textbf{Đánh giá khả năng phát hiện Drift (Detection Benchmark):} So sánh hiệu suất của ShapeDD và biến thể cải tiến (IDW-MMD với asymptotic p-value) với các phương pháp phổ biến (Baseline) trên các tập dữ liệu đa dạng.
	\item \textbf{Đánh giá khả năng thích ứng (Adaptation Evaluation):} Kiểm chứng hiệu quả của chiến lược cập nhật mô hình tự động thông qua chỉ số độ chính xác tích lũy (Prequential Accuracy).
\end{enumerate}

Cấu trúc chương được tổ chức như sau: Mục~\ref{sec:dataset-config} mô tả dữ liệu và môi trường thực nghiệm. Mục~\ref{sec:eval-strategy} trình bày tổng quan chiến lược đánh giá và kiến trúc hệ thống. Mục~\ref{sec:detection-eval} đi sâu vào so sánh hiệu suất phát hiện drift. Mục~\ref{sec:classification-eval} phân tích module phân loại (SE-CDT). Cuối cùng, Mục~\ref{sec:adaptation-eval} đánh giá hiệu quả thích ứng trên luồng dữ liệu.

\subsection{Môi trường và Cấu hình}
\label{sec:dataset-config}
Hệ thống streaming được giả lập sử dụng Apache Kafka\footnote{Triển khai thực nghiệm sử dụng Redpanda v24.1.9, một hệ thống Kafka-compatible với API tương thích 100\%.}.

\textbf{Cấu hình tham số chung:}
\begin{itemize}
	\item Kích thước luồng dữ liệu (Stream length): $10,000$ mẫu/dataset.
	\item Số lượng điểm drift: $10$ điểm/dataset (cách đều nhau).
	\item Độ trễ chấp nhận được (Acceptable delay): $\delta = 150$ mẫu.
	\item Số lần chạy lặp lại (Runs): $30$ lần với các random seed khác nhau để đảm bảo độ tin cậy thống kê ($\alpha = 0.05$).
\end{itemize}

\textbf{Quy ước ký hiệu trong các bảng:}
\begin{itemize}
	\item \textbf{MMD\_IDW}: Inverse Density-Weighted MMD (IDW-MMD), sử dụng trọng số nghịch mật độ
	\item \textbf{ShapeDD\_WMMD\_PROPER}: ShapeDD với IDW-MMD và asymptotic p-value
	\item \textbf{SE\_CDT}: SE-CDT unified detector-classifier system
\end{itemize}

\subsection{Tập dữ liệu thực nghiệm}

Hệ thống được đánh giá trên bộ 10 tập dữ liệu tổng hợp (synthetic datasets), được thiết kế để kiểm tra các khía cạnh cụ thể của thuật toán phát hiện. Các tập dữ liệu được phân loại dựa trên bản chất của sự thay đổi phân phối:

\textbf{Nhóm 1: Sudden Drift (Thay đổi P(X) đột ngột).}
Đây là trọng tâm chính của ShapeDD và IDW-MMD. Các dataset này chứa sự thay đổi đột ngột trong phân phối đầu vào $P(X)$ (Covariate Shift), nơi các phương pháp unsupervised cần phải phát hiện chính xác.
\begin{itemize}
	\item \textit{Gaussian Shift (Moderate):} Dữ liệu phân phối chuẩn đa chiều ($d=10$) với sự dịch chuyển trung bình (mean shift) đột ngột ($\delta=1.5$). Đây là trường hợp lý tưởng để kiểm tra độ nhạy của kernel RBF.
	\item \textit{STAGGER Concepts:} Bộ dữ liệu kinh điển với các đặc trưng nhị phân. Mặc dù thường được dùng cho supervised drift, nó cũng chứa sự thay đổi phân phối $P(X)$ do cách lấy mẫu, tạo ra tín hiệu drift rõ ràng.
	\item \textit{Random Uniform (Sensitivity Test):} Bộ 4 dataset (\textit{mild, moderate, severe, ultra\_severe}) được sinh ngẫu nhiên với cường độ thay đổi (intensity) tăng dần từ 0.125 đến 2.0. Bộ này dùng để đánh giá "ngưỡng phát hiện" (detection threshold) của các thuật toán.
\end{itemize}

\textbf{Nhóm 2: Blip Drift (Thay đổi ngắn hạn).}
\begin{itemize}
	\item \textit{RBF Blips:} Dữ liệu được sinh từ các trọng tâm Gaussian (50 centroids) di chuyển đột ngột và quay lại trạng thái cũ trong thời gian ngắn. Thử thách khả năng bắt tín hiệu nhanh của MMD-Agg (multi-scale).
\end{itemize}

\textbf{Nhóm 3: Virtual Drift / Concept Drift thuần túy (Control Group).}
Nhóm này bao gồm các dataset chỉ có sự thay đổi về biên quyết định $P(Y|X)$ trong khi phân phối đầu vào $P(X)$ giữ nguyên (hoặc thay đổi không đáng kể).
\begin{itemize}
	\item \textit{Standard SEA:} Thay đổi ngưỡng phân lớp $x_1 + x_2 > \theta$.
	\item \textit{Rotating Hyperplane:} Mặt siêu phẳng xoay dần trong không gian.
	\item \textit{LED Abrupt:} Thay đổi quy tắc hiển thị số trên đèn LED (7 features).
\end{itemize}

\textbf{Mục đích kiểm chứng:} Đối với các phương pháp phát hiện drift không giám sát (như ShapeDD, MMD), kết quả lý tưởng trên nhóm này là \textbf{không phát hiện} (hoặc phát hiện rất ít), vì $P(X)$ không đổi. Việc benchmark trên nhóm này giúp xác nhận thuật toán không bị "ảo giác" (hallucination) trước các thay đổi chỉ mang tính ngữ nghĩa nhãn.

\subsection{Chiến lược đánh giá và Kiến trúc hệ thống}
\label{sec:eval-strategy}

Trước khi so sánh với các phương pháp hiện có, cần làm rõ kiến trúc của hệ thống đề xuất để định hình chiến lược đánh giá. Hệ thống ShapeDD-Stream được thiết kế theo kiến trúc modular gồm ba thành phần chính tương ứng với 3 giai đoạn xử lý:

\begin{enumerate}
	\item \textbf{Detection Module (ShapeDD\_WMMD\_PROPER):}
	Kết hợp ShapeDD với IDW-MMD và asymptotic p-value để phát hiện thời điểm xảy ra drift. Module này ưu tiên giảm thiểu Positive Rate (FP) và độ trễ.
	
	\item \textbf{Classification Module (SE-CDT):}
	Phân loại loại drift (sudden, gradual, incremental, recurrent, blip) dựa trên tín hiệu drift magnitude $\sigma(t)$. SE-CDT hoạt động hoàn toàn \textit{không giám sát} bằng cách phân tích hình dạng của $\sigma(t)$ trên các cửa sổ trượt đa kích thước.
	
	\item \textbf{Adaptation Module:}
	Kích hoạt chiến lược thích ứng phù hợp dựa trên kết quả classification: Full Reset (sudden), Incremental Update (gradual/incremental), Concept Memory (recurrent).
\end{enumerate}

Tương ứng với kiến trúc này, phần đánh giá sẽ được chia thành 3 phần: (1) Đánh giá Detection Module so với baseline, (2) Đánh giá Classification Module (SE-CDT) và lựa chọn tham số tối ưu, (3) Đánh giá hiệu quả thích ứng của toàn bộ pipeline (End-to-End).

\section{Đánh giá phương pháp phát hiện Drift}
\label{sec:detection-eval}

Phần này so sánh Detection Module của hệ thống đề xuất với các phương pháp state-of-the-art hiện có: KS-Test (thống kê cổ điển), MMD (kernel-based), DAWIDD (window-based), D3 (discriminative), và ShapeDD gốc (2021). Trọng tâm đánh giá là khả năng phát hiện \textbf{Sự thay đổi phân phối đầu vào} $P(X)$ (Distribution Shift / Covariate Shift).

\subsection{Kết quả so sánh tổng hợp}

Bảng~\ref{tab:comprehensive_performance} so sánh hiệu suất của \textbf{phương pháp đề xuất} (MMD\_IDW, ShapeDD\_WMMD\_PROPER, SE\_CDT) với \textbf{các baseline} (MMD standard, KS-Test, D3, DAWIDD, ShapeDD gốc). Các chỉ số F1 được tính dựa trên khả năng phát hiện đúng các điểm drift đã biết (ground truth), kết quả được tổng hợp từ 30 lần chạy độc lập trên 11 tập dữ liệu (tổng 330 experiments).

% =============================================================================
% Bảng tổng hợp hiệu suất
% =============================================================================
\input{../../results/tables/table_I_comprehensive_performance.tex}

\textbf{Phân tích kết quả:}
\begin{itemize}
	\item \textbf{MMD\_IDW dẫn đầu về F1 (0.548):} Phương pháp IDW-MMD đạt F1-score cao nhất nhờ sự cân bằng giữa Precision (0.589) và Recall (0.567), với số báo động giả thấp (2.5 FP/run). Điều này xác nhận hiệu quả của cơ chế trọng số nghịch mật độ trong việc giảm phương sai ước lượng.
	\item \textbf{SE-CDT và ShapeDD\_WMMD\_PROPER (F1 = 0.481):} Hai phương pháp đề xuất đạt Precision cao (0.539) với \textbf{không có báo động giả} (FP = 0) trên benchmark detection. Đây là đặc điểm phù hợp cho các hệ thống yêu cầu độ ổn định. Độ trễ phát hiện thấp nhất (18 mẫu) cho thấy khả năng phản ứng nhanh. \textit{Lưu ý:} FP = 0 một phần do phương pháp không phát hiện drift trên các dataset virtual drift (hyperplane, led\_abrupt, standard\_sea) nơi $P(X)$ không đổi --- đây là hành vi thiết kế của phương pháp unsupervised.
	\item \textbf{D3 xếp thứ 2 (F1 = 0.488):} Phương pháp discriminative này hoạt động tốt với Precision cao (0.553) và FP thấp (0.9), nhưng Recall hạn chế (0.474) do phụ thuộc vào khả năng học của classifier.
	\item \textbf{MMD baseline (F1 = 0.455):} Phương pháp MMD chuẩn đạt Recall cao (0.722) nhưng Precision thấp (0.348), dẫn đến 14.3 báo động giả trung bình mỗi lần chạy.
	\item \textbf{Sự đánh đổi của KS-Test (F1 = 0.289):} Phương pháp Kolmogorov-Smirnov đạt Recall cao nhất (0.796) nhưng lại có Precision thấp nhất (0.188) với số lượng báo động giả lớn (36.6 FP/run). Điều này cho thấy KS quá nhạy cảm với nhiễu, không phù hợp cho các hệ thống giám sát tự động yêu cầu độ tin cậy cao.
\end{itemize}

\subsection{Phân tích ý nghĩa thống kê}

Để khẳng định sự khác biệt về hiệu suất không phải do ngẫu nhiên, biểu đồ Critical Difference (CD) sử dụng kiểm định Friedman và Nemenyi post-hoc test được trình bày trong Hình~\ref{fig:critical_difference}.

\begin{figure}[h]
	\centering
	\includegraphics[width=0.9\textwidth]{../../results/plots/critical_difference_f1.png}
	\caption[Biểu đồ Critical Difference (CD)]{Biểu đồ Critical Difference (CD) với mức ý nghĩa $\alpha = 0.05$. SE\_CDT và ShapeDD\_WMMD\_PROPER nằm ở nhóm đầu (rank thấp nhất là tốt nhất).}
	\label{fig:critical_difference}
\end{figure}

Kết quả kiểm định Friedman cho thấy MMD cơ bản có thứ hạng trung bình tốt nhất (3.64), tiếp theo là MMD\_IDW (3.91). SE\_CDT và ShapeDD\_WMMD\_PROPER xếp hạng 4-5 (4.50) với Critical Difference = 3.0. Điều này cho thấy không có sự khác biệt thống kê có ý nghĩa lớn về F1 giữa các phương pháp top, nhưng \textbf{SE\_CDT/ ShapeDD\_WMMD\_PROPER có sự khác biệt ở chỉ số FP = 0} --- yếu tố quan trọng trong môi trường production.

\subsection{Đánh giá chi tiết trên từng loại dữ liệu}

Hiệu suất của các phương pháp thay đổi tùy thuộc vào đặc tính của tập dữ liệu (Bảng~\ref{tab:f1_by_dataset_part1}, Bảng~\ref{tab:f1_by_dataset_part2} và Bảng~\ref{tab:f1_by_dataset_part3}).

% =============================================================================
% Bảng F1 theo Dataset
% =============================================================================
\input{../../results/tables/table_II_f1_by_dataset.tex}

\begin{figure}[h]
	\centering
	\includegraphics[width=0.9\textwidth]{../../results/plots/fig_prequential_mixed.png}
	\caption[Minh họa tín hiệu phát hiện trên dữ liệu Sudden Drift]{Minh họa tín hiệu phát hiện trên dữ liệu Sudden Drift (trong kịch bản Mixed A). ShapeDD tạo ra hình dạng "tam giác cân" đặc trưng (Subplot 03) tại điểm drift, đúng như dự báo lý thuyết.}
	\label{fig:sudden_drift_vis}
\end{figure}

\textbf{Phân tích sâu:}
\begin{enumerate}
	\item \textbf{Kết quả trên Drift mạnh (Severe/Sudden):}
	      Trên các dataset như \textit{gaussian\_shift\_moderate}, \textit{stagger}, và \textit{gen\_random\_severe/ultra\_severe}, phương pháp ShapeDD\_WMMD\_PROPER và SE\_CDT đạt F1 ở mức cao ($\geq 0.97$). Hình~\ref{fig:sudden_drift_vis} minh họa ShapeDD tạo thành hình tam giác đúng tại thời điểm drift.
	\item \textbf{Thách thức với Drift nhẹ (Mild Drift) và Cơ chế IDW-MMD:}
	      Trên tập \textit{gen\_random\_mild}, hiệu suất của SE\_CDT/ ShapeDD\_WMMD\_PROPER giảm mạnh (F1 = 0.006) so với MMD truyền thống (F1 = 0.585).
	      \textit{Lý giải:} IDW-MMD gán trọng số thấp cho vùng mật độ cao, vô tình làm lu mờ tín hiệu drift nhẹ diễn ra trong vùng này (over-smoothing), dẫn đến tỷ lệ False Negative cao.
	\item \textbf{Hành vi trên Virtual Drift (Control Group):}
	      Trên các dataset \textit{hyperplane}, \textit{led\_abrupt}, và \textit{standard\_sea}, SE\_CDT/ ShapeDD\_WMMD\_PROPER đạt F1 = 0.0. Đây là \textbf{hành vi mong đợi} vì các dataset này chỉ có sự thay đổi $P(Y|X)$. Khác với các baseline giám sát (supervised baselines) thường báo động sai khi Accuracy giảm, phương pháp unsupervised chỉ tập trung vào $P(X)$, giúp hệ thống không bị "đánh lừa" bởi các thay đổi chỉ mang tính chất nhãn (label shift) mà bản chất dữ liệu không đổi.
	\item \textbf{Blip Drift:}
	      Trên tập \textit{rbfblips}, SE\_CDT đạt F1 = 1.0. Cơ chế shape detection kết hợp IDW-MMD cho kết quả tốt với các thay đổi ngắn hạn, đột ngột.
	\item \textbf{Phân tích Báo động giả (False Positives):}
	      Hình~\ref{fig:stationary_fp} so sánh số lượng báo động giả. KS-Test tạo ra lượng báo động sai lớn nhất (36.6 FP/run). SE\_CDT và ShapeDD\_WMMD\_PROPER duy trì \textbf{0 False Positives}, nhờ vào cơ chế shape detection chặt chẽ.
\end{enumerate}

\begin{figure}[h]
	\centering
	\includegraphics[width=0.9\textwidth]{../../experiments/publication_figures/vis_repeated_gradual_SE.png}
	\caption[Minh họa tín hiệu trên dữ liệu Gradual Drift]{Minh họa tín hiệu trên dữ liệu Gradual Drift. Tín hiệu (màu đỏ - Subplot 03) không tạo thành đỉnh nhọn rõ ràng mà bị san phẳng.}
	\label{fig:gradual_drift_vis}
\end{figure}

\begin{figure}[h]
	\centering
	\includegraphics[width=0.9\textwidth]{../../results/plots/figure_4_stationary_fp.png}
	\caption[Phân tích số lượng báo động giả trên tập dữ liệu tĩnh]{Phân tích số lượng báo động giả trên tập dữ liệu tĩnh (Stationary). KS tạo ra nhiều báo động sai nhất, trong khi các phương pháp MMD và D3 ổn định hơn.}
	\label{fig:stationary_fp}
\end{figure}

\subsection{Đánh giá hiệu suất tính toán (Runtime \& Throughput)}

Bảng~\ref{tab:runtime_stats} so sánh thời gian và thông lượng.

\input{../../results/tables/table_III_runtime_stats.tex}

\textbf{Các kết quả chính:}
\begin{itemize}
	\item \textbf{Tăng tốc gấp 17--20 lần:} SE\_CDT đạt thông lượng $\sim 131,500$ mẫu/giây (7.6ms/window), nhanh gấp \textbf{20.5 lần} so với ShapeDD gốc ($\sim 7,987$ mẫu/giây).
	\item \textbf{Ý nghĩa thực tiễn:} Với thông lượng $>100,000$ mẫu/giây, hệ thống đủ khả năng đáp ứng các ứng dụng yêu cầu độ trễ thấp như giám sát log máy chủ hay giao dịch tài chính tần suất cao, nơi mà chi phí tính toán của phương pháp hoán vị (permutation test) truyền thống là rào cản lớn.
\end{itemize}

\section{Đánh giá SE-CDT: Phân loại drift không giám sát}
\label{sec:classification-eval}

Phần này đánh giá hiệu quả của \textbf{Classification Module} (SE-CDT). Khác với các phương pháp supervised yêu cầu labels, SE-CDT hoạt động hoàn toàn không giám sát bằng cách phân tích hình dạng tín hiệu drift magnitude $\sigma(t)$.

\subsection{Thiết kế thực nghiệm}

\textbf{Cấu hình:} Dataset tổng hợp 8,000 mẫu với các loại drift TCD (Sudden, Blip) và PCD (Gradual, Incremental, Recurrent).
\textbf{Đánh giá:} 17 configurations × 10 runs = 170 test cases. Tham số: window\_size=200, stride=40.

Để tối ưu hóa hiệu suất phân loại, trước khi đưa ra kết quả cuối cùng, chúng tôi tiến hành hai bước hiệu chỉnh quan trọng: (1) Lựa chọn biến thể MMD phù hợp cho module phân loại, và (2) Hiệu chỉnh ngưỡng phát hiện (Threshold Calibration).

\subsection{Lựa chọn biến thể MMD: Standard vs IDW-MMD}
\label{sec:mmd-variant-choice}

Trong quá trình phát triển SE-CDT, chúng tôi đã thử nghiệm cả hai biến thể MMD. Mặc dù IDW-MMD hoạt động tốt cho Detection (như đã thấy ở phần trước), kết quả thực nghiệm lại chỉ ra nó không phù hợp cho Classification.

\textbf{Kết quả so sánh:}
\begin{itemize}
	\item \textbf{IDW-MMD:} CAT Accuracy 20.0\%, bỏ lỡ \textit{tất cả} các điểm drift Gradual/Incremental (MDR = 1.0).
	\item \textbf{Standard MMD:} CAT Accuracy 85.8\%, phát hiện tốt cả 5 loại drift.
\end{itemize}

\textbf{Lý do:} IDW-MMD sử dụng trọng số nghịch biến với mật độ ($w_{i} \propto 1/\sqrt{d_i}$). Cơ chế này tập trung vào các điểm outlier vùng biên để bắt sudden drift, nhưng lại vô tình "lọc bỏ" các tín hiệu thay đổi nhỏ, đồng đều của gradual drift (vốn thường diễn ra trong vùng mật độ cao). Ngược lại, Standard MMD tính toán bình đẳng trên toàn bộ mẫu, do đó bảo toàn được cấu trúc của các tín hiệu drift diễn ra từ từ.
$\rightarrow$ \textbf{Quyết định thiết kế:} Hệ thống sử dụng mô hình lai: \textit{Detection Module} dùng IDW-MMD (tối ưu độ nhạy biên), còn \textit{Classification Module} dùng Standard MMD (giữ lại thông tin toàn cục).

\subsection{Calibration ngưỡng phát hiện}
\label{sec:secdt-threshold}

Việc lựa chọn ngưỡng ($\tau$) ảnh hưởng trực tiếp đến độ nhạy. Thông qua phân tích sơ bộ trên dữ liệu validation streaming:
\begin{itemize}
	\item \textbf{Ngưỡng mặc định ($\tau = 0.5$):} Quá cao (conservative), không phát hiện được drift nào trên dữ liệu streaming demo.
	\item \textbf{Ngưỡng hiệu chỉnh ($\tau = 0.15$):} Cân bằng tốt nhất. Ngưỡng này đủ thấp để bắt được các tín hiệu drift vừa phải (moderate drift) nhưng đủ cao để lọc bỏ nhiễu ngẫu nhiên.
\end{itemize}
Do đó, các kết quả phân loại dưới đây sử dụng $\tau = 0.15$.

\subsection{Kết quả phân loại}

Bảng~\ref{tab:se-cdt-results} trình bày kết quả phân loại sử dụng cấu hình đã chọn (Standard MMD, $\tau=0.15$).

\begin{table}[H]
	\centering
	\caption{Kết quả phân loại drift type của SE-CDT}
	\label{tab:se-cdt-results}
	\input{../../results/tables/table_se_cdt_aggregate.tex}
\end{table}

\textbf{Phân tích:}
\begin{itemize}
	\item \textbf{Kết quả độ chính xác:} SE-CDT (Standard MMD) đạt độ chính xác nhóm (CAT) = \textbf{85.8\%} và độ chính xác subcategory (SUB) = \textbf{46.6\%}.
	\item \textbf{Event Detection Rate (EDR):} Đạt 94.4\%, nghĩa là phát hiện phần lớn các drift. Đổi lại, số lượng báo động giả (FP) cao hơn so với IDW-MMD (1394 vs 171), nhưng trong ngữ cảnh classification (sau khi detection module đã lọc), ưu tiên là không bỏ sót thông tin để phân loại đúng.
	\item \textbf{Hạn chế:} Hệ thống hiện tại xử lý Recurrent drift như chuỗi các sự kiện Sudden riêng lẻ, chưa có cơ chế bộ nhớ dài hạn.
\end{itemize}

\subsection{So sánh với CDT\_MSW}
\label{sec:secdt-vs-cdtmsw}

Để có cái nhìn so sánh, chúng tôi đối chiếu SE-CDT với CDT\_MSW~\cite{guo2022cdtmsw} --- một phương pháp supervised tiêu biểu phân loại drift dựa trên accuracy drop.

\textit{Lưu ý về phương pháp:} Do hạn chế về mã nguồn mở, so sánh này sử dụng một implementation độc lập của CDT\_MSW dựa trên mô tả trong bài báo gốc. Các tham số như window size (50 samples) có thể chưa tối ưu cho SVC học decision boundary phức tạp, nên kết quả mang tính chất tham khảo cho tiềm năng của phương pháp unsupervised.

\begin{table}[H]
	\centering
	\caption{So sánh tổng hợp SE-CDT và CDT\_MSW (17 configs × 10 runs)}
	\label{tab:cdt-comparison-unified}
	\begin{tabular}{|l|c|c|c|c|c|c|}
		\hline
		\textbf{Method}       & \textbf{EDR$\uparrow$} & \textbf{MDR$\downarrow$} & \textbf{FP$\downarrow$} & \textbf{CAT} & \textbf{SUB} & \textbf{Type} \\
		\hline
		CDT\_MSW              & 14.4\%                 & 85.6\%                   & 247                     & 38.7\%       & 18.7\%       & Supervised      \\
		\textbf{SE-CDT (Std)} & \textbf{94.4\%}        & \textbf{5.6\%}           & 1394                    & \textbf{85.8\%} & \textbf{46.6\%} & \textbf{Unsupervised}  \\
		\hline
	\end{tabular}
\end{table}

\textbf{Nhận xét:}
Trong điều kiện thử nghiệm này, SE-CDT (Std) vượt trội về CAT Accuracy (85.8\% vs 38.7\%) và khả năng phát hiện sự kiện (EDR 94.4\% vs 14.4\%). Ngay cả khi thử nghiệm với "concept-aware labels" (điều kiện lý tưởng cho supervised), SE-CDT vẫn duy trì EDR cao hơn. Điều này có thể được lý giải bởi hai yếu tố kỹ thuật:
\begin{itemize}
    \item \textbf{Độ nhạy của MMD với $P(X)$:} SE-CDT đo trực tiếp sự thay đổi phân phối đặc trưng, trong khi CDT\_MSW phải chờ đợi model classifier "sai dần" (accuracy drop). Khi dữ liệu ít (window nhỏ), accuracy signal thường có độ trễ và nhiễu lớn hơn MMD signal.
    \item \textbf{Giới hạn của Window Size:} Với $window\_size=50$, classifier SVC trong CDT\_MSW có thể gặp khó khăn để học decision boundary đủ tốt, dẫn đến accuracy baseline thấp và khó phát hiện sự sụt giảm. Điều này cho thấy phương pháp unsupervised có lợi thế trong môi trường "data-scarce" (dữ liệu khan hiếm) hoặc "fast-changing" (thay đổi nhanh).
\end{itemize}

\section{Đánh giá khả năng thích ứng mô hình}
\label{sec:adaptation-eval}

Sau khi phát hiện drift, hệ thống kích hoạt quy trình thích ứng. Phần này đánh giá hiệu quả của chiến lược thích ứng theo loại drift (Type-Specific Adaptation) sử dụng chỉ số \textbf{Prequential Accuracy}.

\subsection{Thiết lập thực nghiệm}
Thực nghiệm chạy trên hệ thống Kafka streaming demo với ngưỡng SE-CDT $\tau=0.15$. Luồng dữ liệu gồm 5,000 mẫu với các loại drift Sudden, Gradual và Recurrent.

\subsection{Phân biệt Real Drift và Virtual Drift trong thích ứng}
Như đã thảo luận ở Mục~\ref{sec:overview} và Mục~\ref{sec:detection-eval}, các phương pháp unsupervised như SE-CDT được thiết kế để phát hiện Real Drift (thay đổi $P(X)$) và bỏ qua Virtual Drift (chỉ đổi $P(Y|X)$). Do đó, các kết quả đánh giá thích ứng dưới đây tập trung vào các kịch bản Real Drift, nơi SE-CDT có thể phát huy tác dụng kích hoạt learning.

\subsection{Kết quả phục hồi (Recovery)}

Bảng~\ref{tab:prequential-results} tổng hợp kết quả Prequential Accuracy.

\begin{table}[H]
	\centering
	\caption{Kết quả Prequential Accuracy theo loại drift (Mixed scenario, SE-CDT threshold = 0.15)}
	\label{tab:prequential-results}
	\begin{tabular}{|l|c|c|c|}
		\hline
		\textbf{Loại Drift} & \textbf{Type-Specific} & \textbf{No Adaptation} & \textbf{Improvement} \\
		\hline
		Sudden (Real P(X))  & \textbf{98.67\%}       & 99.60\%                & -0.9\%*              \\
		Gradual             & 80.80\%                & 79.02\%                & +2.3\%               \\
		Mixed (Combined)    & \textbf{85.46\%}       & 81.26\%                & +5.2\%               \\
		\hline
	\end{tabular}
\end{table}

\textbf{Kết quả:}
\begin{itemize}
	\item \textbf{Mixed scenario (+5.2\%):} Khi kết hợp nhiều loại drift, chiến lược Type-Specific Adaptation cho thấy sự cải thiện so với baseline.
	\item \textbf{Sudden drift:} Hệ thống phát hiện sớm (EDR=100\%, độ trễ thấp), giúp model thích ứng nhanh (Hình~\ref{fig:prequential_sudden}).
	\item \textbf{Gradual Drift:} Vẫn là thách thức chung do tín hiệu MMD bị san phẳng.
\end{itemize}

\begin{figure}[H]
	\centering
	\includegraphics[width=0.95\textwidth]{../../results/plots/fig_prequential_sudden.png}
	\caption[Prequential Accuracy trên Sudden Drift]{Prequential Accuracy trên Sudden Drift. SE-CDT phát hiện drift chính xác (markers), giúp duy trì accuracy >98\%.}
	\label{fig:prequential_sudden}
\end{figure}

\section{Kết luận chương}

Các kết quả thực nghiệm dẫn đến những kết luận chính sau:
\begin{enumerate}
	\item \textbf{Detection:} Phương pháp đề xuất (ShapeDD\_WMMD\_PROPER) đạt sự cân bằng giữa hiệu suất và độ tin cậy với **0 False Positives**, đồng thời tăng tốc độ xử lý lên **20 lần** so với ShapeDD gốc.
	\item \textbf{Classification:} Module SE-CDT (sử dụng Standard MMD) cho thấy khả năng phân loại loại drift (85.8\%) mà không cần dán nhãn dữ liệu, cao hơn các baseline trong điều kiện thử nghiệm.
	\item \textbf{Adaptation:} Việc tích hợp phát hiện và phân loại drift vào quy trình thích ứng giúp cải thiện độ chính xác tổng thể (+5.2\%) trong môi trường dữ liệu hỗn hợp.
\end{enumerate}

Kết quả này cho thấy tính khả thi của kiến trúc đề xuất cho các hệ thống giám sát luồng dữ liệu thời gian thực.
