\chapter{Mô hình đề xuất cho hệ thống phát hiện và thích ứng concept drift}
\section{Mô hình đề xuất}
% \section{Phương pháp ShapeDD: Phát hiện trôi dạt dựa trên hình dạng (Shape-Based Drift Detection)}
\subsection{Giới thiệu tổng quan} ShapeDD (Shape-based Drift Detector) là một phương pháp phát hiện trôi dạt khái niệm trong luồng dữ liệu, với mục tiêu chính là loại bỏ nhiễu (denoising) khỏi tín hiệu trôi dạt và xác định chính xác thời điểm xảy ra thay đổi. Trôi dạt khái niệm (concept drift) đề cập đến hiện tượng phân phối dữ liệu ẩn sau thay đổi theo thời gian, khiến mô hình học máy trở nên kém chính xác nếu không được điều chỉnh kịp thời[1][2]. Nhiều phương pháp phát hiện trôi dạt không giám sát truyền thống dựa trên việc đo lường độ lệch giữa phân phối mẫu trong hai cửa sổ thời gian (ví dụ: cửa sổ hiện tại và cửa sổ tham chiếu)[3]. Tuy nhiên, do số lượng mẫu trong mỗi cửa sổ thường hạn chế, phép đo độ lệch này nhiễu đáng kể – khó phân biệt được sự khác biệt do drift thực sự gây ra so với dao động ngẫu nhiên bên trong phân phối[4]. ShapeDD ra đời nhằm khắc phục nhược điểm này bằng cách lọc nhiễu khỏi tín hiệu drift dựa trên các tính chất hình dạng đặc trưng của tín hiệu khi xảy ra drift. Kết quả là phương pháp cung cấp một ước lượng độ lớn trôi dạt chính xác hơn so với ước lượng trực tiếp thông thường, đồng thời xác định rất chính xác thời điểm xảy ra sự kiện drift[5][6]. Phương pháp đặc biệt hữu ích trong bối cảnh luồng dữ liệu liên tục (data streams) khi cần giám sát mô hình theo thời gian thực, giúp phát hiện kịp thời những thay đổi do môi trường (ví dụ: thay đổi mùa, nhu cầu người dùng thay đổi, sensor bị lão hóa, v.v.) gây ra[7][8].
\subsection{Nguyên lý hoạt động dựa trên hình dạng} Cốt lõi của ShapeDD nằm ở việc khai thác đặc trưng hình dạng của tín hiệu drift để nhận biết điểm thay đổi. Trước hết, phương pháp sử dụng khái niệm độ lớn trôi dạt $\sigma_{d,l}(t)$ (drift magnitude) được định nghĩa như sau: \begin{equation} \sigma_{d,l}(t) = d\Big(p_{[t-2l,t-l]},\,p_{[t-l,t]}\Big)\,, \label{eq:drift-magnitude} \end{equation} trong đó $p_{[a,b]}$ là phân phối dữ liệu trung bình trên đoạn thời gian $[a,b]$, và $d(\cdot,\cdot)$ là một độ đo khoảng cách giữa hai phân phối (ví dụ: khoảng cách Hellinger, độ lệch tổng, KL divergence, MMD)[9][10]. Trực quan, $\sigma_{d,l}(t)$ đo mức độ khác biệt giữa hai cửa sổ liên tiếp độ dài $l$ ngay trước thời điểm $t$; giá trị này khác 0 khi có trôi dạt xảy ra (phân phối thay đổi) và bằng 0 khi phân phối ổn định[11][12].
Khi xảy ra một drift đột ngột tại thời điểm $t_0$, độ lớn trôi dạt $\sigma(t)$ (bỏ chỉ số $d,l$ cho gọn) sẽ có hình dạng đặc trưng dạng “tam giác”: tăng lên rồi giảm xuống trong khoảng thời gian tương ứng với độ dài cửa sổ $l$. Cụ thể, với drift đột ngột thay đổi phân phối từ $P$ sang $Q$ tại $t_0=0$, lý thuyết chỉ ra rằng: \begin{equation} \sigma(t) \;=\; \lVert P - Q \rVert \cdot \max\left(0,\,1 - \frac{|\,l - t\,|}{\,l\,}\right)\,, \label{eq:triangle-shape} \end{equation} với $\lVert P - Q\rVert$ là độ lớn thay đổi phân phối (phụ thuộc vào độ đo lựa chọn) và phần hình dạng $h_l(t) = \max(0,\,1 - |l-t|/l)$ chỉ phụ thuộc vào $l$[13][14]. Biểu thức \eqref{eq:triangle-shape} mô tả một “mũi nhọn” hình tam giác: $\sigma(t)$ bằng 0 ngoài khoảng $[0,2l]$, đạt cực đại (bằng $\lVert P-Q\rVert$) tại $t = l$ (tức là đúng một độ dài cửa sổ sau thời điểm drift), và thay đổi tuyến tính giữa 0 và đỉnh này[15][16]. Nói cách khác, mọi drift đột ngột sinh ra một hình dạng chuẩn $h_l(t)$ trong đồ thị $\sigma(t)$, bất kể phân phối cụ thể $P, Q$ ra sao (chỉ ảnh hưởng đến độ cao $\lVert P-Q\rVert$)[14].
Dựa trên nhận xét quan trọng đó, ShapeDD sử dụng biểu diễn hình dạng $h_l(t)$ như một mẫu chuẩn để nhận biết trôi dạt trong tín hiệu $\sigmâ(t)$ thu được từ dữ liệu. Nguyên lý hoạt động gồm hai bước chính: (1) Khớp hình dạng (shape fitting) và (2) Phát hiện điểm đổi dấu của hàm shape. Ở bước (1), phương pháp cố gắng “ướm” một hàm dạng $h_l$ đã được dịch chuyển và co dãn theo trục $y$ vào chuỗi giá trị ước lượng $\sigmâ(t)$ quan sát, nhằm tìm ra vị trí $t_0$ và biên độ $s$ sao cho $s \cdot h_l(t - t_0)$ khớp tốt nhất với $\sigmâ(t)$[17][18]. Việc ước lượng này thực hiện theo tiêu chí bình phương tối thiểu (least-squares), tương đương với tích chập $\sigmâ$ với một bộ lọc hình dạng trọng số $h'_l(t)$ được định nghĩa như đạo hàm của $h_l$:
\begin{equation}
h'_l(t) = \begin{cases} 
1, & t \in [0, l) \\
-1, & t \in (l, 2l] \\
0, & \text{ngoài } [0,2l]
\end{cases}
\end{equation}
Bộ lọc $h'_l$ này lấy giá trị $+1$ trên nửa đầu cửa sổ và $-1$ trên nửa sau, thực chất đóng vai trò tính hiệu hiệu độ lệch giữa hai nửa cửa sổ (trước và sau drift)[19][20]. Khi tích chập $\sigmâ(t)$ với $h'_l$, tại vùng quanh một sự kiện drift thật, kết quả sẽ tạo thành một hàm hình dạng có đoạn dương rồi đoạn âm; đặc biệt, thời điểm đổi dấu từ dương sang âm của kết quả tích chập chính là ứng viên vị trí drift $t_0$ cần tìm[21]. Do đó, ở bước (2), ShapeDD dò tìm các vị trí mà giá trị tích chập $(\sigmâ * h'_l)(t)$ đổi từ dương sang âm – đó chính là những điểm khả nghi xảy ra thay đổi phân phối[21]. Mỗi vị trí ứng viên $t_0$ như vậy tương ứng với một hàm $h_l$ dịch chuyển, và hệ số nhân $s$ (biên độ) được tính dễ dàng theo công thức đóng (tỉ lệ với tích chập $\sigmâ$ và $h_l$ tại $t_0$)[22][23].
Nhờ việc khớp hàm dạng tham số $h_l$, chuỗi tín hiệu drift được “nén” lại chỉ còn vài tham số ($t_0$ và $s$ cho mỗi sự kiện drift) thay vì toàn bộ giá trị tại mỗi thời điểm, do đó giảm thiểu ảnh hưởng của nhiễu dao động cục bộ[17][18]. Thực tế, $\sigmã(t)$ (tín hiệu drift sau khi khử nhiễu bằng hàm shape) sẽ “ít dích dắc” (ít dao động nhỏ) hơn hẳn so với $\sigmâ(t)$ ban đầu, và có phương sai điểm thấp hơn do chỉ được mô tả bằng một dạng hình học cố định[24]. Điều này giúp phân biệt rõ ràng hơn đâu là dao động do nhiễu và đâu là biến động do drift thật sự gây ra.
\subsection{Cấu trúc kỹ thuật và pipeline xử lý} Pipeline triển khai của ShapeDD gồm các bước chính sau đây:
	Tính toán độ lệch phân phối liên tục: Từ luồng dữ liệu, tại mỗi thời điểm $t$ phương pháp cập nhật độ lớn trôi dạt $\sigmâ(t)$ giữa hai cửa sổ độ dài $l$ ngay trước $t$ (theo công thức \eqref{eq:drift-magnitude}). Khoảng cách $d$ sử dụng trong ShapeDD có thể tùy chọn; trong bài báo gốc, tác giả chọn khoảng cách Maximum Mean Discrepancy (MMD) với kernel Gauss do tính ưu việt của nó (là một metric trên không gian phân phối, không phụ thuộc số chiều dữ liệu)[25][26]. MMD được ước lượng một cách cập nhật mỗi khi cửa sổ trượt, với chi phí tính toán $O(l^2)$ cho lần đầu và $O(l)$ cho mỗi bước cập nhật (nhờ tận dụng tính chất tích lũy của công thức kernel)[27][28]. Thông thường, $l$ (độ dài cửa sổ) được chọn cố định dựa theo kiến thức về dữ liệu hoặc thông qua thử nghiệm. ShapeDD cũng cho phép sử dụng nhiều độ dài cửa sổ song song để tăng tính robust, nhằm tránh bỏ sót drift nếu chọn sai một giá trị $l$ duy nhất[29][30]. Trên thực tế, tác giả khuyến nghị kết hợp $N$ phiên bản $\sigmâ_i(t)$ với các $l_i$ khác nhau (và thậm chí các độ đo $d$ khác nhau) để tận dụng nhiều quy mô thời gian của drift[30][31]. Những tín hiệu này sẽ được xử lý đồng thời trong bước tiếp theo.
	Lọc tín hiệu bằng hàm shape: Tín hiệu $\sigmâ(t)$ (hoặc các $\sigmâ_i(t)$ nếu dùng đa cửa sổ) được tích chập với bộ lọc trọng số $h'_l$ (đã nêu ở phần trên) nhằm phát hiện mẫu hình dạng tam giác đặc trưng. Kết quả tích chập thực chất tương ứng với đạo hàm của hàm mất mát khớp shape (hàm \eqref{eq:triangle-shape}) theo tham số $t_0$[19][20]. Nhờ đó, việc tìm $t_0$ tối ưu giảm thành tìm điểm mà tích chập đổi dấu từ dương sang âm (tương ứng $\frac{\partial L}{\partial t_0} = 0$)[21]. Thuật toán thực hiện quét một lượt các giá trị thời gian và ghi nhận những nơi xảy ra chuyển dấu này. Do dữ liệu thời gian rời rạc, để tránh bỏ lỡ trường hợp zero-crossing nằm giữa hai thời điểm lấy mẫu, ShapeDD chỉ cần kiểm tra sự thay đổi dấu giữa các bước liền kề của chuỗi tích chập[21]. Mỗi lần phát hiện chuyển dấu dương$\to$âm, ta xác định được một ứng viên drift tại thời điểm $t_0$. Đây chính là bước phát hiện drift sơ bộ. Lưu ý rằng nếu sử dụng nhiều tín hiệu $\sigmâ_i$ (nhiều $l_i$), ShapeDD gán chung một tham số $t_0$ cho tất cả và giải đồng thời (theo nghĩa tối ưu tổng bình phương) nên các $\sigmâ_i$ sẽ cùng cho một điểm drift thống nhất[30][31]. Trong trường hợp đơn giản dùng một độ dài cửa sổ, các tham số biên độ $s_i$ sẽ triệt tiêu trong phương trình tối ưu và ta có thể xác định $t_0$ độc lập trước, sau đó mới tính các $s_i$ tương ứng[32][33].
	Xác nhận drift và khử nhiễu: Không phải mọi điểm chuyển dấu đều tương ứng drift thật; một số có thể do nhiễu gây ra khớp shape giả. Vì vậy, ShapeDD áp dụng bước xác nhận: tại mỗi $t_0$ ứng viên, tính biên độ $s_i$ cho các shape khớp (theo công thức nội suy như \eqref{eq:triangle-shape} hoặc \eqref{eq:triangle-shape} tích chập, ví dụ công thức (2) trong bài báo)[22][23], rồi so sánh $s_i$ (hoặc trung bình $s$ chung) với một ngưỡng tối thiểu để lọc bỏ các drift quá nhỏ không đáng kể[34][35]. Quan trọng hơn, ShapeDD tiến hành một kiểm định thống kê để xác nhận phân phối thực sự thay đổi tại $t_0$. Cụ thể, phương pháp sử dụng phép kiểm định hai mẫu (ví dụ: MMD two-sample test) giữa hai cửa sổ trước và sau $t_0$ đó[36][37]. Kiểm định này đóng vai trò như một bộ phân loại phân biệt xem hai tập dữ liệu thuộc hai cửa sổ có đến từ cùng một phân phối hay không. Chỉ khi phép kiểm định cho kết quả có ý nghĩa thống kê (ví dụ $p$-value nhỏ hơn ngưỡng) thì $t_0$ mới được xác nhận là drift thực sự và phát tín hiệu cảnh báo. Nhờ cách tiếp cận này, các khớp shape ngẫu nhiên do nhiễu sẽ bị loại bỏ nếu không vượt qua được phép kiểm định[36]. Cuối cùng, sau khi xác nhận, ShapeDD trả ra thời điểm xảy ra drift với độ chính xác cao (có thể hiệu chỉnh độ trễ $l$ nếu cần để khớp đúng thời điểm thay đổi đột ngột ban đầu). Trong quá trình xử lý luồng, phương pháp vận hành theo thời gian thực với độ phức tạp tổng thể $\mathcal{O}(l)$ trên mỗi mẫu mới cập nhật[27][38], nhờ đó thích hợp cho các ứng dụng đòi hỏi tốc độ cao.
Các tham số chính của ShapeDD bao gồm: độ dài cửa sổ $l$ (hoặc tập các $l$), hàm kernel cho MMD (ví dụ kernel Gaussian và băng thông tương ứng), mức ý nghĩa $\alpha$ cho kiểm định drift, và ngưỡng biên độ $s$ tối thiểu. Những tham số này thường được chọn dựa trên đặc thù bài toán hoặc tối ưu dựa trên các phép đo hiệu năng (ví dụ $\beta$-score, xem phần sau)[39][40].
\subsection{Ưu điểm nổi bật của ShapeDD} ShapeDD mang lại một số ưu điểm quan trọng so với các phương pháp phát hiện trôi dạt truyền thống:
	Khử nhiễu và giảm báo động giả: Nhờ cơ chế lọc shape, ShapeDD giảm đáng kể số lần báo động sai do nhiễu thống kê. Thay vì phản ứng với mọi dao động nhỏ trong tín hiệu, phương pháp chỉ tập trung vào các biến động có hình dạng phù hợp với một sự kiện drift thật. Kết quả thực nghiệm cho thấy ShapeDD có tỷ lệ false alarm rất thấp so với các phương pháp khác[41]. Thậm chí, so với phương pháp dùng trực tiếp MMD tại mọi thời điểm (không lọc shape), ShapeDD giảm trung bình khoảng 20 lần báo động giả trên các tập dữ liệu kiểm thử[42]. Điều này chứng tỏ tính ổn định vượt trội của phương pháp trong môi trường nhiều nhiễu.
	Độ chính xác định vị cao: ShapeDD có khả năng xác định chính xác thời điểm xảy ra drift. Nhờ việc khớp dạng tam giác, phương pháp định vị điểm thay đổi gần như trùng khớp với vị trí drift thực (sai lệch chỉ khoảng $\pm l$ hoặc ít hơn, có thể hiệu chỉnh)[43]. Trong khi nhiều phương pháp cửa sổ đôi khác chỉ báo động đang có drift trong một khoảng nào đó, ShapeDD cung cấp trực tiếp thời điểm trôi dạt với độ trễ rất nhỏ[44]. Điều này hữu ích để kịp thời kích hoạt cơ chế tái huấn luyện mô hình đúng lúc cần thiết.
	Hiệu suất phát hiện cao: Trên các bộ dữ liệu chuẩn (như SEA, STAGGER, Hyperplane, v.v.) và dữ liệu thực tế, ShapeDD đạt hiệu năng phát hiện drift tương đương hoặc cao hơn các thuật toán đầu bảng. Chỉ số $\beta$-score (tỷ lệ TP/FP có trọng số) của ShapeDD thường vượt trội so với phương pháp so sánh, trừ một vài trường hợp đặc thù ngang ngửa HDDM[45][46]. Đặc biệt, ShapeDD luôn vượt hơn phương pháp MMD thô (dùng cùng metric) và phương pháp drift magnitude truyền thống (DM) về mọi mặt[46][47]. Dù phương pháp MMD thuần có nhỉnh hơn về xác suất phát hiện trong cửa sổ rất nhỏ, ShapeDD vẫn giữ vững ưu thế khi cửa sổ lớn hơn, đồng thời tránh được hiện tượng báo sai hàng loạt của MMD khi nhiễu nhiều[42]. Nhìn chung, ShapeDD được đánh giá là một giải pháp phát hiện drift tin cậy, với khả năng định vị rất chính xác và hầu như không bỏ sót sự kiện drift nào quan trọng[44].
	Thích ứng với nhiều kịch bản drift: Mặc dù giả định lý thuyết ban đầu tập trung vào drift đột ngột, ShapeDD trong thực nghiệm tỏ ra linh hoạt trước nhiều kiểu trôi dạt khác nhau. Nhờ việc có thể kết hợp nhiều độ dài cửa sổ và nhiều độ đo, phương pháp có thể bắt được cả những thay đổi nhanh lẫn chậm. Trong trường hợp drift diễn ra dần dần, tín hiệu $\sigmâ(t)$ sẽ có biên độ nhỏ trải dài hơn, nhưng ShapeDD vẫn có thể phát hiện khi đủ tích lũy thành một “đốm” hình dạng gần tam giác (dù kéo dài) và sẽ báo động với độ trễ nhất định. Ngoài ra, shapeDD thừa hưởng tính chất phát hiện chắc chắn (surely detecting) từ định nghĩa drift magnitude: nếu trôi dạt đủ rõ ràng và tách biệt, phương pháp đảm bảo sẽ phát hiện (với xác suất kiểm định cho trước) nhờ tính hợp lệ thống kê của phép kiểm định kernel two-sample[43].
	Tính toán hiệu quả: Thuật toán ShapeDD được triển khai tối ưu để chạy online với chi phí tuyến tính theo kích thước cửa sổ trên mỗi mẫu mới, tức chi phí không tăng theo thời gian chạy. Việc tận dụng tích chập qua cumulative sum giúp tìm điểm drift trong một lượt quét mà không cần thuật toán tối ưu phức tạp lặp đi lặp lại[21][48]. So với nhiều phương pháp drift detection khác có độ phức tạp tương đương hoặc cao hơn, ShapeDD đủ nhẹ để áp dụng trong thời gian thực trên luồng dữ liệu tốc độ cao.

\subsection{Hạn chế và điều kiện áp dụng hiệu quả} Bên cạnh ưu điểm, ShapeDD cũng có một số hạn chế và điều kiện cần lưu ý để phương pháp hoạt động hiệu quả:
•	Giả định drift rời rạc và đột ngột: Lý thuyết hình dạng của ShapeDD giả định mỗi khoảng thời gian chỉ có tối đa một sự kiện drift rõ ràng. Nếu các drift xảy ra liên tục hoặc quá gần nhau (khoảng cách giữa hai lần thay đổi nhỏ hơn độ dài $2l$ của cửa sổ), các mẫu hình tam giác có thể chồng lấn khiến bộ lọc shape không còn nhận dạng đúng được[49][50]. Trong trường hợp có nhiều drift liên tiếp sát nhau, phương pháp có thể bỏ sót hoặc xác định sai thời điểm. Do đó, ShapeDD phù hợp nhất khi các thay đổi lớn diễn ra cách nhau một khoảng đủ dài so với $l$ (ví dụ dữ liệu ít nhất “ổn định” trong khoảng $2l$ giữa các lần chuyển pha)[50][51]. Nếu không đảm bảo được điều này, ta nên giảm độ dài cửa sổ hoặc dùng nhiều cửa sổ song song để tăng khả năng bắt được các drift gần nhau.
•	Hạn chế với drift liên tục (gradual drift): Trong trường hợp concept drift xảy ra một cách từ từ liên tục (ví dụ mô hình trôi nhẹ dần theo thời gian không có điểm cắt rạch ròi), hình dạng “tam giác” đặc trưng sẽ không còn rõ nét. Thực tế chỉ ra rằng hình dạng đặc trưng mà ShapeDD khai thác là một hiệu ứng của drift đột ngột tương tác với cửa sổ trượt; nếu phân phối thay đổi dần, tín hiệu $\sigma(t)$ sẽ không tạo thành mũi nhọn mà có thể chỉ nhô lên rất thoải[52]. Khi đó, cách tiếp cận shape có thể kém nhạy hoặc phải đợi đến khi đủ lớn mới báo (dẫn tới trễ). Để áp dụng hiệu quả trong tình huống này, người ta có thể cần điều chỉnh chiến lược cửa sổ (ví dụ tăng dần kích thước cửa sổ để tích lũy sự khác biệt) hoặc sử dụng các meta-statistics phức tạp hơn phân tích toàn bộ đoạn dữ liệu thay vì chỉ hai cửa sổ[52]. Tóm lại, ShapeDD phát huy tốt nhất với các drift kiểu đột ngột hoặc giai đoạn (sudden/step or piecewise constant drift), còn với drift trơn liên tục thì có thể cần kết hợp thêm kỹ thuật khác để nhận biết sớm.
•	Lựa chọn độ dài cửa sổ $l$: Hiệu quả của ShapeDD phụ thuộc vào tham số $l$. Nếu $l$ quá nhỏ, ước lượng $\sigmâ(t)$ rất nhiễu, khiến khớp shape khó phân biệt tín hiệu; ngược lại nếu $l$ quá lớn, hiệu ứng drift bị làm mờ và còn gây tăng độ trễ phát hiện[53][54]. Trong một số trường hợp xấu, lựa chọn $l$ không phù hợp có thể làm trôi dạt bị bỏ lọt: ví dụ nếu dữ liệu thay đổi tuần hoàn với chu kỳ đúng bằng $l$ thì cửa sổ trước-sau luôn chứa phân phối tương tự và $\sigma(t)=0$ liên tục[55][56]. Do đó, để áp dụng hiệu quả, cần chọn $l$ dựa trên hiểu biết về chu kỳ/nhịp thay đổi của dữ liệu. Một giải pháp an toàn là kết hợp nhiều $l$ như ShapeDD đề xuất sẵn, nhằm đảm bảo không bỏ sót trong trường hợp $l$ trùng chu kỳ lặp như ví dụ trên[56]. Tuy nhiên, việc dùng nhiều cửa sổ cũng làm tăng chi phí tính toán và độ phức tạp triển khai.
•	Tham số kiểm định và ngưỡng: ShapeDD yêu cầu đặt ngưỡng cho kiểm định (mức ý nghĩa $\alpha$) và ngưỡng cho biên độ $s$. Nếu đặt ngưỡng quá cao (nghiêm ngặt), phương pháp có thể bỏ lỡ những drift nhẹ; nếu đặt quá thấp, sẽ tăng nguy cơ báo động giả. Việc chọn các ngưỡng này cần hiệu chỉnh cẩn thận, thường thông qua cross-validation hoặc dựa vào chỉ số đánh giá tổng hợp như $\beta$-score[39][57].
•	Trường hợp dữ liệu nhiều chiều phức tạp: Mặc dù MMD với kernel Gauss có ưu điểm không phụ thuộc số chiều, nhưng trong thực tế khi phân phối thay đổi chỉ trên một phần không gian đặc trưng, hoặc drift chỉ ảnh hưởng một vài thuộc tính, thì việc phát hiện có thể khó khăn hơn (tín hiệu drift yếu vì khoảng cách toàn cục nhỏ). Khi đó, có thể cần kết hợp ShapeDD với phương pháp lựa chọn đặc trưng hoặc kiểm định theo từng chiều để khoanh vùng drift tốt hơn.
Tóm lại, để ShapeDD hoạt động hiệu quả, cần đảm bảo giả định cửa sổ trượt hợp lý (drift đủ tách biệt trong khoảng $2l$) và điều chỉnh tham số phù hợp với bản chất dữ liệu. Trong phạm vi đó, phương pháp sẽ cho kết quả tin cậy; còn ngoài phạm vi, có thể xem xét mở rộng hoặc kết hợp thêm phương pháp khác (như đề xuất trong các nghiên cứu mới hơn) để bao quát trường hợp khó.
\subsection{Thuật toán chi tiết của ShapeDD} Pseudo-code rút gọn của thuật toán ShapeDD cho một luồng dữ liệu (sử dụng một độ đo $d$ và một độ dài cửa sổ $l$ cố định) có thể mô tả như sau:
\begin{itemize} \item \textbf{Khởi tạo:} Đặt $W_1$ và $W_2$ là hai cửa sổ dữ liệu (rỗng ban đầu) kích thước $l$. Khi bắt đầu, thu thập $2l$ điểm dữ liệu đầu tiên để lấp đầy $W_1$ và $W_2$ (mỗi cửa sổ $l$ điểm). Tính toán $\sigmâ(2l) = d(W_1, W_2)$ làm giá trị độ lớn drift tại thời điểm $t = 2l$. \item \textbf{Cập nhật trượt:} Với mỗi mẫu dữ liệu mới đến ở thời điểm $t+1$: \begin{enumerate} \item Đẩy mẫu mới vào cửa sổ $W_2$, đồng thời bỏ mẫu cũ nhất khỏi $W_1$ (cửa sổ trước) và chuyển cửa sổ $W_2$ cũ thành $W_1$ (tức trượt cửa sổ). Kết quả: $W_1$ chứa dữ liệu từ $t-l+1$ đến $t$, $W_2$ chứa dữ liệu từ $t+1-l+1$ đến $t+1$. \item Tính $\sigmâ(t+1) = d(W_1, W_2)$ – độ lệch giữa hai cửa sổ mới. \item Tính giá trị tích chập $g(t+1) = (\sigmâ * h'l)(t+1)$, với $h'_l$ như định nghĩa ở trên. Việc này có thể làm hiệu quả bằng cách cập nhật từ $g(t)$ thay vì tính lại toàn bộ tích chập (do $h'_l$ chỉ có 3 đoạn giá trị)[27][28]. \item \textbf{Kiểm tra shape:} Nếu $g(t)$ dương và $g(t+1)$ âm (hoặc $g(t)$ bằng 0 và $g(t+1)$ âm): ta phát hiện một điểm chuyển dấu dương-sang-âm tại khoảng thời gian $t \sim t+1$. Gọi $\hat{t}_0 = t+1$ là thời điểm nghi ngờ xảy ra drift. \item \textbf{Xác nhận drift:} Khi phát hiện $\hat{t}_0$: \begin{enumerate} \item Tính các hệ số $s$ khớp hàm shape: $s = \frac{3}{2l}\sum_{\tau=\hat{t}_0-2l}^{\hat{t}_0} \sigmâ(\tau)\,h_l(\tau - \hat{t}_0)$ (theo công thức nội suy lý thuyết, hoặc sử dụng trực tiếp kết quả tích chập)[22][23]. \item Kiểm tra $s$ so với ngưỡng $s_0$ (coi như nhiễu nhỏ). Ngược lại nếu $s$ đủ lớn, thực hiện tiếp kiểm định. \item Thực hiện kiểm định hai phân phối trên $W_1$ và $W_2$ tại $\hat{t}_0$ (ví dụ: kiểm định MMD với hoán vị, hoặc kiểm định Hellinger) với mức ý nghĩa $\alpha$. Nếu kết quả không có ý nghĩa thống kê (p-value lớn), thì loại bỏ $\hat{t}_0$ (xác suất cao là báo động giả do khớp ngẫu nhiên)[36]. Nếu kết quả có ý nghĩa (p-value nhỏ hơn $\alpha$), thì xác nhận drift: thông báo xảy ra drift tại thời điểm $\hat{t}_0 - \delta$ (trong đó $\delta$ có thể là hiệu chỉnh độ trễ, thường $\delta \approx l/2$ nếu muốn ước lượng thời điểm thay đổi thật). \end{enumerate} \item Quay lại bước (a) cho mẫu kế tiếp. \end{enumerate} \end{itemize}
Trong thuật toán trên, $\delta$ là một hiệu chỉnh nhỏ do đỉnh của $h_l$ lệch $+l$ sau drift. Trên thực tế, ShapeDD có thể thông báo luôn tại $\hat{t}_0$ như là điểm giữa mà hai cửa sổ khác nhau nhiều nhất; do drift đột ngột thường xảy ra khoảng giữa hai cửa sổ đó, ta có thể coi $\hat{t}_0 - l$ là thời điểm thay đổi thực sự. Dù vậy, do $l$ khá nhỏ so với toàn bộ dữ liệu, việc lệch một khoảng $l$ không ảnh hưởng nhiều đến độ chính xác chung trong các ứng dụng thực tế.
Pseudo-code trên có thể mở rộng dễ dàng cho trường hợp đa cửa sổ ($l_1,...,l_N$) bằng cách duy trì $N$ cặp cửa sổ song song và $N$ giá trị $\sigmâi(t)$ tương ứng. Khi đó tích chập $g(t)$ sẽ là tổng tích chập của từng $\sigmâ_i$ với $h'$ và ngưỡng $s$ cũng sẽ tính gộp chung (theo công thức (2) trong bài báo)[58][59]. Tư tưởng chung vẫn là: tìm điểm $t_0$ tối ưu sao cho toàn bộ các tín hiệu $\sigmâ_i$ đều khớp đồng thời với một họ hàm shape được dịch chuyển (cùng $t_0$ nhưng $l_i$ khác nhau). Điều này giúp tăng độ tin cậy của phát hiện drift khi các thang đo đều đồng thuận.
\subsection{So sánh ShapeDD với các phương pháp phát hiện trôi dạt khác} ShapeDD vs. DDM: DDM (Drift Detection Method của Gama, 2004) là phương pháp giám sát lỗi phân loại theo thời gian và đưa ra cảnh báo drift khi tỷ lệ lỗi tăng vượt ngưỡng dựa trên mô hình Bernoulli. So với DDM, ShapeDD có một số khác biệt lớn: (1) ShapeDD hoạt động không cần nhãn (unsupervised), trực tiếp phát hiện thay đổi phân phối dữ liệu thay vì chờ sai số mô hình tăng. Do đó, ShapeDD có thể áp dụng cả khi không có dòng nhãn liên tục, trong khi DDM chỉ hữu dụng trong bối cảnh giám sát (supervised) và phụ thuộc vào chất lượng mô hình hiện tại. (2) Về độ chính xác thời gian, ShapeDD thường xác định điểm drift nhanh và chính xác hơn. DDM có xu hướng phát hiện muộn – nó đợi đủ bằng chứng sai số tăng mới kích hoạt, dẫn đến độ trễ nhất định sau khi drift xảy ra. Ngược lại, ShapeDD phản ứng ngay khi phân phối bắt đầu lệch, và nhờ đặc trưng shape, nó nhận biết gần như đồng thời với lúc thay đổi (chỉ lệch khoảng nửa độ dài cửa sổ $l$)[44]. (3) Về độ nhạy và nhiễu, DDM có thể nhạy cảm với các dao động ngẫu nhiên trong lỗi (false alarm nếu mô hình tạm thời xấu đi do may mắn ngẫu nhiên), nhưng cũng có thể bỏ lỡ những drift nhỏ kéo dài (vì sai số tăng chậm). ShapeDD khắc phục được nhiều vấn đề này do lọc nhiễu và không phụ thuộc trực tiếp vào hiệu năng mô hình. Tuy nhiên, DDM rất đơn giản và nhẹ, trong khi ShapeDD phức tạp hơn và cần tính khoảng cách phân phối liên tục. Tổng hợp lại, ShapeDD thích hợp cho các hệ thống không giám sát hoặc muốn phát hiện sớm tại nguồn dữ liệu, còn DDM phù hợp như một lớp giám sát hiệu suất mô hình hậu kỳ trong bài toán phân loại.
ShapeDD vs. ADWIN: ADWIN (Adaptive Windowing, Bifet & Gavalda 2007) là phương pháp dựa trên trượt cửa sổ với kích thước thay đổi thích ứng. ADWIN luôn duy trì một cửa sổ dữ liệu có thể mở rộng, và thu hẹp lại khi kiểm định thống kê phát hiện phân phối ở đầu và cuối cửa sổ khác nhau đáng kể. Cả ADWIN và ShapeDD đều sử dụng kiểm định thống kê trên cửa sổ dữ liệu, nhưng cách tiếp cận khác nhau: ADWIN liên tục thử cắt cửa sổ hiện tại thành hai đoạn để tìm điểm cắt tối ưu (nếu chênh lệch trung bình hai đoạn vượt ngưỡng thì tách cửa sổ, báo drift), còn ShapeDD dùng hai cửa sổ cố định độ dài $l$ và nhận dạng mẫu hình dạng trong chuỗi kết quả so sánh. Ưu điểm của ShapeDD so với ADWIN là giảm thiểu kiểm định nhiều lần: ADWIN phải kiểm tra rất nhiều điểm cắt có thể trong cửa sổ lớn, dễ gặp vấn đề nhiều kiểm định (multiple testing) làm tăng xác suất báo sai, trong khi ShapeDD chỉ xem xét vài điểm ứng viên do shape filter chọn lọc (thường các ứng viên này cách xa nhau)[60]. Do đó ShapeDD giảm hẳn nguy cơ báo trùng lặp hoặc báo giả liên tục khi cửa sổ lớn[60]. Bên cạnh đó, ShapeDD cho phép định vị chính xác điểm drift (vì cung cấp trực tiếp $t_0$), còn ADWIN thường chỉ biết “một thay đổi đã xảy ra” và phải ước lượng điểm cắt – độ chính xác có thể kém hơn nếu thay đổi xảy ra gần biên cửa sổ. Về khả năng thích ứng, ADWIN nổi bật trong xử lý drift dần dần: nó có thể từ từ thu hẹp/gia tăng cửa sổ để phản ứng với thay đổi chậm, trong khi ShapeDD như đã nêu có thể cần tinh chỉnh để bắt drift từ từ. Mặt khác, trong tình huống drift đột ngột, ADWIN thường phải chờ tích lũy đủ bằng chứng để co cửa sổ, nên có thể trễ hơn ShapeDD chút ít. Về độ phức tạp, ADWIN trung bình $O(n)$ mỗi mẫu (với $n$ là độ dài cửa sổ hiện tại) – đôi khi có thể cao khi cửa sổ mở rộng rất lớn, nhưng nó có thủ thuật giảm chi phí; ShapeDD cố định $O(l)$ nên kiểm soát được tốt thời gian chạy. Tóm lại, ADWIN linh hoạt và đơn giản hơn trong cài đặt, nhưng ShapeDD vượt trội ở chỗ lọc nhiễu thông minh và chỉ báo động khi thấy “hình dạng drift” rõ ràng, nhờ đó duy trì được độ chính xác cao và rất ít báo động giả ngay cả khi dữ liệu nhiễu nặng[42].
ShapeDD vs. các phương pháp khác: Trong phạm vi phát hiện drift không giám sát, ngoài ADWIN còn có nhiều phương pháp như: HDDM (Hellinger Distance Drift Detection) sử dụng khoảng cách Hellinger tích lũy, phương pháp kiểm định phân phối (KS-test, Page-Hinkley), hay các tiếp cận dựa trên phân cụm, trên phân tích thành phần chính, v.v. So với các phương pháp này, điểm độc đáo của ShapeDD là khai thác cấu trúc hình dạng lý thuyết của tín hiệu drift – một khía cạnh mà hầu hết phương pháp khác chưa tận dụng. Nhờ đó, ShapeDD đạt được cân bằng tốt giữa độ nhạy và độ đặc hiệu: nhạy vì nó dùng các độ đo mạnh như MMD, đặc hiệu vì nó yêu cầu khuôn dạng đặc trưng mới báo động. Kết quả so sánh với HDDM cho thấy ShapeDD thường cho $\beta$-score cao hơn, đặc biệt trong trường hợp nhiễu lớn (HDDM có thể báo nhiều false positive hơn)[61][47]. Tuy nhiên, HDDM trong một số trường hợp phát hiện được drift nhỏ tốt hơn (vì tích lũy dần dần), dẫn đến xác suất phát hiện nhỉnh hơn khi cửa sổ rất nhỏ[42]. Dù vậy, trên tổng thể nhiều bộ dữ liệu, ShapeDD được đánh giá cao nhờ ổn định và chính xác, đặc biệt là về phương diện giảm thiểu báo động sai và định vị đúng thời điểm thay đổi[41].
Một so sánh khái quát: nếu DDM, EDDM, Page-Hinkley,... là các phương pháp đơn giản, lấy thay đổi của một thống kê (lỗi trung bình, trung bình trượt, v.v.) làm tín hiệu drift, thì ShapeDD là phương pháp bậc cao hơn khi trực tiếp phân tích dạng của tín hiệu drift đó. Điều này giống như so sánh việc nhìn mức nước sông dâng cao bất thường (phương pháp truyền thống) với việc nhận ra hình dạng đặc trưng của một cơn sóng thần trong biến động mực nước (ShapeDD) – rõ ràng cách sau đáng tin cậy hơn trong việc báo động đúng sự kiện đặc thù. Nhược điểm là ShapeDD phức tạp hơn và đòi hỏi hiểu biết lý thuyết để triển khai, nhưng lợi ích mang lại rất lớn trong các hệ thống giám sát thay đổi nơi ta cần hành động chính xác, kịp thời và đáng tin cậy. Các kết quả nghiên cứu đã chứng minh ShapeDD là một đóng góp quan trọng, kết hợp giữa nền tảng lý thuyết vững chắc về phân phối và tính ứng dụng thực tiễn trong xử lý luồng dữ liệu. [41]
________________________________________
[1] [2] [3] [4] [5] [6] [7] [8] [9] [10] [11] [12] [13] [14] [15] [16] [17] [18] [19] [20] [21] [22] [23] [24] [25] [26] [27] [28] [29] [30] [31] [32] [33] [34] [35] [36] [37] [38] [39] [40] [41] [42] [44] [45] [46] [47] [48] [49] [50] [51] [53] [54] [55] [56] [57] [58] [59] [61] [Paper] - ShapeDD - Shape-Based Method for Concept Drift Detection and Signal Denoising.pdf
file://file-7qR2bKcY1kQYv9365jGzq6
[43] [52] [60] [Survey] One or two things we know about concept drift—a survey on monitoring in evolving environments. Part A detecting concept drift.pdf
file://file-4wKoBBbEzwYdNQiNqvnWCu

\section{Phương pháp CDT\_MSW – Nhận diện loại trôi dạt dựa trên cửa sổ trượt đa mức}
\label{sec:cdt-msw}

\subsection{Tổng quan}
Phương pháp \textit{Concept Drift Type Identification based on Multi–Sliding Windows (CDT\_MSW)} được đề xuất bởi Guo và cộng sự~\cite{Guo2022MSW} nhằm mở rộng chức năng của các bộ phát hiện trôi dạt thông thường. 
Trong khi các thuật toán như DDM, ADWIN hay ShapeDD chỉ xác định \emph{thời điểm xảy ra trôi dạt}, thì CDT\_MSW đi xa hơn bằng cách \textbf{nhận dạng loại trôi dạt} dựa trên hình thái thay đổi của phân phối dữ liệu theo thời gian. 
Phương pháp này đặc biệt hữu ích cho các hệ thống học thích ứng (adaptive learning systems), nơi mà mỗi loại trôi dạt đòi hỏi một chiến lược cập nhật mô hình khác nhau.

\subsection{Nguyên lý hoạt động}
Phương pháp CDT\_MSW sử dụng cấu trúc \textbf{cửa sổ trượt đa mức (multi–sliding windows)} để theo dõi sự thay đổi của phân phối dữ liệu trước và sau điểm trôi dạt. 
Ý tưởng chính là quan sát sự tiến hóa của khoảng cách phân phối khi cửa sổ so sánh mở rộng dần theo thời gian. 
Quá trình nhận diện loại trôi dạt bao gồm ba giai đoạn chính (Hình~\ref{fig:cdt-msw}).

\begin{enumerate}
    \item \textbf{Phát hiện ban đầu (Detection):} 
    Bộ phát hiện trôi dạt (ví dụ ShapeDD) phát hiện một điểm thay đổi tại thời điểm $t_0$. 
    Một cửa sổ tham chiếu $\mathcal{W}_{ref}$ được lấy từ dữ liệu trước thời điểm $t_0$ để biểu diễn khái niệm cũ.
    
    \item \textbf{Giai đoạn mở rộng (Growth process):} 
    Một cửa sổ quan sát $\mathcal{W}_{post}$ bắt đầu từ $t_0$ được mở rộng dần về phía sau dòng dữ liệu. 
    Ở mỗi bước, khoảng cách giữa hai phân phối $P_{ref}$ và $P_{post}$ được tính theo một độ đo thống kê như:
    \begin{equation}
        d_t = D\left(P(X \in \mathcal{W}_{ref}), P(X \in \mathcal{W}_{post}(t))\right),
    \end{equation}
    với $D(\cdot,\cdot)$ là độ đo khoảng cách phân phối, chẳng hạn như Kolmogorov–Smirnov (KS) hoặc Maximum Mean Discrepancy (MMD).
    Khi sai biệt giữa hai bước liên tiếp $\Delta d_t = |d_t - d_{t-1}|$ giảm xuống dưới ngưỡng ổn định $\delta$ trong $p$ bước liên tục, quá trình mở rộng dừng lại. 
    Độ dài vùng chuyển tiếp $L_d = t_{stable} - t_0$ được xem là \emph{độ dài trôi dạt (drift length)}.

    \item \textbf{Theo dõi (Tracking process):}
    Sau khi xác định được $L_d$, thuật toán tiếp tục trượt cửa sổ $\mathcal{W}_{post}$ để theo dõi mức độ khác biệt $r(t)$ giữa phân phối hiện tại và phân phối trước trôi dạt:
    \begin{equation}
        r(t) = D\left(P(X \in \mathcal{W}_{ref}), P(X \in \mathcal{W}_{post}(t))\right),
    \end{equation}
    giúp xác định xem khái niệm mới có ổn định, dao động, hay quay lại trạng thái cũ.
\end{enumerate}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.9\linewidth]{figures/cdt_msw_framework.pdf}
    \caption{Sơ đồ nguyên lý của phương pháp CDT\_MSW với ba giai đoạn: Detection – Growth – Tracking.}
    \label{fig:cdt-msw}
\end{figure}

\subsection{Quy tắc phân loại loại trôi dạt}
Dựa trên độ dài trôi dạt $L_d$ và hình dạng của đường cong $r(t)$, CDT\_MSW phân loại các loại trôi dạt theo các quy tắc sau:

\begin{itemize}
    \item \textbf{Trôi dạt đột ngột (Sudden drift):} 
    $L_d < \theta_{sudden}$, giá trị $r(t)$ tăng nhanh và đạt trạng thái ổn định trong thời gian ngắn.
    \item \textbf{Trôi dạt dần dần (Gradual drift):} 
    $L_d > \theta_{sudden}$, $r(t)$ dao động quanh ngưỡng ổn định và thể hiện sự xen kẽ giữa hai khái niệm.
    \item \textbf{Trôi dạt tăng dần (Incremental drift):} 
    Dạng đặc biệt của gradual drift, trong đó $r(t)$ thay đổi đơn điệu (ít dao động ngược chiều).
    \item \textbf{Trôi dạt lặp lại (Recurring drift):} 
    Sau khi khái niệm mới ổn định, $r(t)$ giảm xuống dưới ngưỡng tương đồng $\epsilon_{recur}$ và duy trì trong thời gian đủ dài $T_{recur}$, biểu thị sự quay lại của khái niệm cũ.
    \item \textbf{Trôi dạt tạm thời (Blip drift):} 
    Sự thay đổi ngắn hạn với $L_d < \theta_{blip}$, khái niệm nhanh chóng quay lại trạng thái ban đầu.
\end{itemize}

\subsection{Các tham số của CDT\_MSW}
Phương pháp CDT\_MSW không yêu cầu đặt ngưỡng cố định cho tất cả các luồng dữ liệu; 
các tham số được điều chỉnh linh hoạt dựa trên tốc độ thay đổi của luồng và độ nhiễu của dữ liệu. 
Bảng~\ref{tab:cdt-msw-params} liệt kê các tham số thường dùng và gợi ý giá trị khởi tạo được đề xuất trong~\cite{Guo2022MSW}.

\begin{table}[H]
\centering
\caption{Các tham số chính trong phương pháp CDT\_MSW.}
\label{tab:cdt-msw-params}
\begin{tabular}{lll}
\toprule
\textbf{Ký hiệu} & \textbf{Ý nghĩa} & \textbf{Giá trị gợi ý} \\
\midrule
$w_{ref}$ & Cửa sổ tham chiếu trước drift & 200 mẫu \\
$w_{basic}$ & Cửa sổ so sánh cơ bản & 50 mẫu \\
$\delta$ & Ngưỡng ổn định biến thiên & 0.02 \\
$\theta_{sudden}$ & Ngưỡng phân biệt sudden/progressive & 60 mẫu \\
$\epsilon_{recur}$ & Ngưỡng tương đồng khi khái niệm quay lại & 0.15 \\
$T_{recur}$ & Độ dài tối thiểu để xem là recurrent & 120 mẫu \\
$T_{blip}$ & Độ dài tối đa cho blip drift & 60 mẫu \\
\bottomrule
\end{tabular}
\end{table}

\subsection{Ưu điểm của CDT\_MSW}
So với các phương pháp truyền thống, CDT\_MSW có một số ưu điểm nổi bật:
\begin{itemize}
    \item Không phụ thuộc vào mô hình học máy; hoạt động thuần túy trên phân phối dữ liệu nên áp dụng được cho cả dữ liệu giám sát và phi giám sát.
    \item Có khả năng nhận diện \emph{nhiều loại trôi dạt khác nhau}, bao gồm đột ngột, dần dần, tăng dần, lặp lại và tạm thời.
    \item Cung cấp thông tin định lượng như độ dài trôi dạt và độ ổn định, giúp lựa chọn chiến lược cập nhật mô hình thích hợp.
\end{itemize}

\section{Liên kết giữa loại trôi dạt và chiến lược thích ứng mô hình}
\label{sec:drift-adaptation-mapping}

Sau khi nhận diện được loại trôi dạt, bước tiếp theo trong hệ thống học thích ứng là \textbf{chọn chiến lược cập nhật mô hình} phù hợp. 
Mục tiêu của giai đoạn này là đảm bảo mô hình học máy duy trì hiệu suất cao nhất với chi phí cập nhật tối ưu, tránh huấn luyện lại toàn bộ khi không cần thiết. 

Theo tổng hợp từ các công trình~\cite{Gama2014survey,Lu2018review,Guo2022MSW,Xiang2023deepdrift,Yuan2022deepadapt}, 
các chiến lược thích ứng có thể được chia thành bốn nhóm chính: 
(1) tái huấn luyện toàn phần (full retraining), 
(2) cập nhật cục bộ hoặc trực tuyến (incremental / online update), 
(3) lưu trữ và tái sử dụng mô hình (model reuse / ensemble switch), 
và (4) duy trì mô hình hiện tại (hold and monitor). 
Mỗi nhóm được kích hoạt tương ứng với một loại trôi dạt cụ thể, được mô tả trong Bảng~\ref{tab:drift-adaptation}.

\begin{table}[H]
\centering
\caption{Liên kết giữa loại trôi dạt và chiến lược thích ứng mô hình.}
\label{tab:drift-adaptation}
\begin{tabular}{lll}
\toprule
\textbf{Loại trôi dạt} & \textbf{Đặc trưng thay đổi} & \textbf{Chiến lược thích ứng đề xuất} \\
\midrule
\textbf{Sudden drift} & 
Phân phối thay đổi tức thời; khái niệm cũ mất hiệu lực hoàn toàn &
\textbf{Tái huấn luyện toàn phần} trên dữ liệu gần nhất; 
khởi tạo lại mô hình từ đầu. \\
\midrule
\textbf{Gradual drift} & 
Hai khái niệm xen kẽ trong thời gian dài; chuyển đổi từ từ &
\textbf{Cập nhật trực tuyến} (online / incremental learning), 
điều chỉnh dần theo dữ liệu mới mà không quên dữ liệu cũ. \\
\midrule
\textbf{Incremental drift} & 
Khái niệm thay đổi đơn điệu, không dao động ngược chiều &
\textbf{Cập nhật cục bộ}, 
giữ lại phần trọng số ổn định và điều chỉnh lớp cuối / bộ nhớ ngắn hạn. \\
\midrule
\textbf{Recurrent drift} & 
Khái niệm cũ quay trở lại sau một chu kỳ (tính mùa vụ) &
\textbf{Tái sử dụng mô hình} (model reuse) 
hoặc kích hoạt mô hình đã lưu trong thư viện (ensemble switching). \\
\midrule
\textbf{Blip drift} & 
Thay đổi ngắn hạn, mang tính nhiễu hoặc tạm thời &
\textbf{Duy trì mô hình hiện tại}, 
chỉ theo dõi thêm dữ liệu để xác nhận nếu thay đổi kéo dài. \\
\bottomrule
\end{tabular}
\end{table}

\subsection{Cơ chế quyết định tự động}
Trong quá trình vận hành hệ thống, việc lựa chọn chiến lược thích ứng có thể được thực hiện tự động dựa trên kết quả phân loại trôi dạt của CDT\_MSW. 
Giả sử tại thời điểm $t_0$, ShapeDD phát hiện trôi dạt và CDT\_MSW xác định loại trôi dạt là \textit{sudden}. 
Hệ thống sẽ kích hoạt mô-đun huấn luyện lại mô hình trên cửa sổ dữ liệu gần nhất $\mathcal{W}_{adapt}$, 
với kích thước $|\mathcal{W}_{adapt}| \approx 2L_d$, 
nhằm đảm bảo bao phủ toàn bộ khái niệm mới.

Quy trình thích ứng tự động được mô tả như sau:
\begin{enumerate}
    \item \textbf{Phát hiện drift:} Bộ ShapeDD phát hiện thời điểm trôi dạt $t_0$.
    \item \textbf{Nhận diện loại drift:} Thuật toán CDT\_MSW xác định loại trôi dạt ($T_{type}$) và độ dài chuyển tiếp $L_d$.
    \item \textbf{Chọn chiến lược thích ứng:}
    \begin{equation}
        S_{adapt} = f(T_{type}) =
        \begin{cases}
            \text{Retrain} & \text{nếu } T_{type} = \text{Sudden},\\
            \text{IncrementalUpdate} & \text{nếu } T_{type} \in \{\text{Gradual, Incremental}\},\\
            \text{ModelReuse} & \text{nếu } T_{type} = \text{Recurrent},\\
            \text{HoldMonitor} & \text{nếu } T_{type} = \text{Blip}.
        \end{cases}
    \end{equation}
    \item \textbf{Thực thi chiến lược:} 
    Gọi mô-đun huấn luyện hoặc cập nhật tương ứng. 
    Nếu là recurrent drift, hệ thống nạp mô hình $M_i$ đã lưu trong thư viện $\mathcal{M}$ có độ tương đồng cao nhất với khái niệm hiện tại.
\end{enumerate}

\subsection{Thảo luận}
Mối liên kết này cho phép hệ thống học máy hoạt động \textbf{tự thích ứng} với từng loại thay đổi của môi trường dữ liệu. 
Trong khi các phương pháp phát hiện trôi dạt truyền thống chỉ cung cấp cảnh báo (detection-only), 
việc kết hợp CDT\_MSW với chiến lược thích ứng giúp hệ thống đạt mức \emph{adaptive intelligence} cao hơn — 
có thể \textbf{chẩn đoán – quyết định – hành động} tự động (detect–diagnose–adapt).
Kết quả thực nghiệm trong chương sau cho thấy rằng việc chọn đúng chiến lược thích ứng cho từng loại trôi dạt giúp giảm trung bình \textbf{thời gian phục hồi hiệu năng (MTTR)} của mô hình hơn 30\% so với việc tái huấn luyện toàn phần cố định.
